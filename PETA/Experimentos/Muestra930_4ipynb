{"cells":[{"cell_type":"code","execution_count":1,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":19906,"status":"ok","timestamp":1677512592002,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"},"user_tz":180},"id":"xhN8vz1PQ8Wv","outputId":"69d78603-c995-4ed0-f191-225eb5dda6bb"},"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/gdrive\n"]}],"source":["try:\n","    from google.colab import drive\n","    drive.mount('/content/gdrive')\n","except ModuleNotFoundError:\n","    print('Not running on Google')"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"vpyelL4yXvC0","executionInfo":{"status":"ok","timestamp":1677512592003,"user_tz":180,"elapsed":5,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["%matplotlib inline"]},{"cell_type":"markdown","metadata":{"id":"ChL61Twesn0o"},"source":[]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":3580,"status":"ok","timestamp":1677512595579,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"},"user_tz":180},"id":"sRvvbIrxP5Hd","outputId":"51b5404a-480b-4b26-e0d5-22368d811574"},"outputs":[{"output_type":"stream","name":"stdout","text":["PyTorch Version:  1.13.1+cu116\n","Torchvision Version:  0.14.1+cu116\n"]}],"source":["from __future__ import print_function, division\n","import os\n","import time\n","import copy\n","import torch\n","import pandas as pd\n","from skimage import io, transform\n","import numpy as np\n","import matplotlib.pyplot as plt\n","from torch.utils.data import Dataset, DataLoader\n","import torchvision\n","from torchvision import transforms, utils, models, datasets\n","import torch.nn as nn\n","import torch.optim as optim\n","import nibabel as nib\n","import scipy.ndimage as ndi\n","from pathlib import Path\n","from PIL import Image\n","import io\n","import json\n","import random\n","\n","# Ignore warnings\n","import warnings\n","warnings.filterwarnings(\"ignore\")\n","print(\"PyTorch Version: \",torch.__version__)\n","print(\"Torchvision Version: \",torchvision.__version__)"]},{"cell_type":"code","execution_count":4,"metadata":{"id":"HErqZ9GNCDq6","executionInfo":{"status":"ok","timestamp":1677512595580,"user_tz":180,"elapsed":17,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["imagesFolder = '/content/gdrive/MyDrive/Tesis/Imagenes/ADNI-MUESTRA-FULL-stripped-preprocessed'\n","trainDatasetCSV = '/content/gdrive/MyDrive/Tesis/Imagenes/ADNI-MUESTRA-930/MUESTRA_train.csv'\n","valDatasetCSV =   '/content/gdrive/MyDrive/Tesis/Imagenes/ADNI-MUESTRA-930/MUESTRA_val.csv'\n","experimentName = 'Muestra930_performance_aux'\n","experimentOutputFolder = '/content/gdrive/MyDrive/Tesis/Experimentos/muestra930_4'\n","experimentDescription = 'Testeo de  stripping y removiendo las superfícies menores a 90x90. Nuevo código, carga imágenes. Salida auxiliar habilitada.'\n","executions = 1"]},{"cell_type":"code","execution_count":5,"metadata":{"id":"VYNyT00wpzwU","executionInfo":{"status":"ok","timestamp":1677512595580,"user_tz":180,"elapsed":16,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["# Models to choose from [resnet, alexnet, vgg, squeezenet, densenet, inception]\n","model_name = \"inception\"\n","\n","# Number of classes in the dataset\n","num_classes = 3\n","\n","# Batch size for training (change depending on how much memory you have)\n","batch_size = 10\n","\n","dl_num_workers = 4\n","\n","# Number of epochs to train for\n","num_epochs = 50\n","\n","# Flag for feature extracting. When False, we finetune the whole model,\n","#   when True we only update the reshaped layer params\n","feature_extract = False\n","\n","usePretrained = True\n","\n","# Habilita la salida auxiliar\n","auxEnabled = True\n","\n","learningRate = 0.0001\n","dropoutRate = 0.6\n","crossEntrophyWeigths = torch.tensor([1.0,1.0,1.0])\n","\n","# Data augmentation\n","dataAugmentation = {\n","    \"angleTransformChance\": 0.1,\n","    \"zoomTransformChance\": 0.1,\n","    \"shiftTransformChance\": 0.0\n","}\n","# dataAugmentation = {}\n","\n","validationCacheSize = 300\n","trainCacheSize = 0\n","\n","debug = False"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"a2ZFcEXjwezm","executionInfo":{"status":"ok","timestamp":1677512596337,"user_tz":180,"elapsed":772,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["f = open(os.path.join(experimentOutputFolder, experimentName + \"_params.txt\"), \"w\")\n","f.write(\"batch_size: \" + str(batch_size) + \"\\n\")\n","f.write(\"dl_num_workers: \" + str(dl_num_workers) + \"\\n\")\n","f.write(\"epochs: \" + str(num_epochs) + \"\\n\")\n","f.write(\"feature_extract: \" + str(feature_extract) + \"\\n\")\n","f.write(\"usePretrained: \" + str(usePretrained) + \"\\n\")\n","f.write(\"auxEnabled: \" + str(auxEnabled) + \"\\n\")\n","f.write(\"learningRate: \" + str(learningRate) + \"\\n\")\n","f.write(\"dropoutRate: \" + str(dropoutRate) + \"\\n\")\n","f.write(\"cross entrophy weights: \" + str(crossEntrophyWeigths) + \"\\n\")\n","f.write(\"dataAugmentation: \" + str(json.dumps(dataAugmentation)) + \"\\n\")\n","f.write(\"executions: \" + str(executions) + \"\\n\")\n","f.write(\"validationCacheSize: \" + str(validationCacheSize) + \"\\n\")\n","f.write(\"trainCacheSize: \" + str(trainCacheSize) + \"\\n\")\n","f.close()"]},{"cell_type":"code","execution_count":7,"metadata":{"id":"zJYNgYD9AC4X","executionInfo":{"status":"ok","timestamp":1677512596337,"user_tz":180,"elapsed":6,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["f = open(os.path.join(experimentOutputFolder, experimentName + \"_descripcion.txt\"), \"w\")\n","f.write(experimentDescription)\n","f.close()"]},{"cell_type":"code","source":["def logDebug(str):\n","    if debug:\n","        print(str)"],"metadata":{"id":"kbR_0LKedYLw","executionInfo":{"status":"ok","timestamp":1677512596338,"user_tz":180,"elapsed":6,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"execution_count":8,"outputs":[]},{"cell_type":"code","execution_count":9,"metadata":{"id":"VDba_NBLQOou","executionInfo":{"status":"ok","timestamp":1677512596338,"user_tz":180,"elapsed":6,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["# https://stackoverflow.com/questions/8598673/how-to-save-a-pylab-figure-into-in-memory-file-which-can-be-read-into-pil-image\n","def fig2img(fig):\n","    \"\"\"Convert a Matplotlib figure to a PIL Image and return it\"\"\"\n","    buf = io.BytesIO()\n","    fig.savefig(buf, facecolor='black', dpi = 64, transparent=False) # dpi Requerido para que la imagen sea 512x512\n","    buf.seek(0)\n","    img = Image.open(buf)\n","    return img"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"K-Z1h8wrQaiB","executionInfo":{"status":"ok","timestamp":1677512596338,"user_tz":180,"elapsed":5,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["def clipped_zoom(img, zoom_factor, **kwargs):\n","\n","    h, w = img.shape[:2]\n","\n","    # For multichannel images we don't want to apply the zoom factor to the RGB\n","    # dimension, so instead we create a tuple of zoom factors, one per array\n","    # dimension, with 1's for any trailing dimensions after the width and height.\n","    zoom_tuple = (zoom_factor,) * 2 + (1,) * (img.ndim - 2)\n","\n","    # Zooming out\n","    if zoom_factor < 1:\n","\n","        # Bounding box of the zoomed-out image within the output array\n","        zh = int(np.round(h * zoom_factor))\n","        zw = int(np.round(w * zoom_factor))\n","        top = (h - zh) // 2\n","        left = (w - zw) // 2\n","\n","        # Zero-padding\n","        out = np.zeros_like(img)\n","        out[top:top+zh, left:left+zw] = ndi.zoom(img, zoom_tuple, **kwargs)\n","\n","    # Zooming in\n","    elif zoom_factor > 1:\n","\n","        # Bounding box of the zoomed-in region within the input array\n","        zh = int(np.round(h / zoom_factor))\n","        zw = int(np.round(w / zoom_factor))\n","        top = (h - zh) // 2\n","        left = (w - zw) // 2\n","\n","        out = ndi.zoom(img[top:top+zh, left:left+zw], zoom_tuple, **kwargs)\n","\n","        # `out` might still be slightly larger than `img` due to rounding, so\n","        # trim off any extra pixels at the edges\n","        trim_top = ((out.shape[0] - h) // 2)\n","        trim_left = ((out.shape[1] - w) // 2)\n","        out = out[trim_top:trim_top+h, trim_left:trim_left+w]\n","\n","    # If zoom_factor == 1, just return the input array\n","    else:\n","        out = img\n","    return out"]},{"cell_type":"code","source":["class SelectGridImage(object):\n","    \"\"\"Selects a grid from the image\n","    \"\"\"\n","    def __init__(self, angleTransformChance = 0.0, zoomTransformChance = 0.0, shiftTransformChance = 0.0):\n","        self.angleTransformChance = angleTransformChance\n","        self.zoomTransformChance = zoomTransformChance\n","        self.shiftTransformChance = shiftTransformChance\n","\n","    def __call__(self, studyID):\n","        # angleTransformChance = 0.1, zoomTransformChance = 0.1, shiftTransformChance = 0.1,\n","        filename = \"normal.png\"\n","        if self.angleTransformChance > random.uniform(0.0, 1.0):\n","            filename = random.choice([\"angle15Left.png\", \"angle15Right.png\"])\n","        if random.uniform(0.0, 1.0) < self.zoomTransformChance:\n","            filename = random.choice([\"zoomIn.png\", \"zoomOut.png\"])\n","        if random.uniform(0.0, 1.0) < self.shiftTransformChance:\n","            filename = random.choice([\"shiftXLeft.png\", \"shiftXRight.png\", \"shiftYTop.png\", \"shiftYBottom.png\"])\n","        \n","        return os.path.join(studyID, filename)"],"metadata":{"id":"eVgG7KAS5zyq","executionInfo":{"status":"ok","timestamp":1677512596758,"user_tz":180,"elapsed":424,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","source":["class LoadGridImage(object):\n","    \"\"\"Loads an image\n","    \"\"\"\n","\n","    def __call__(self, filePath):\n","      fullPath = os.path.join(imagesFolder, filePath)\n","\n","      return Image.open(fullPath)"],"metadata":{"id":"nAA2bysa6kdx","executionInfo":{"status":"ok","timestamp":1677512596759,"user_tz":180,"elapsed":13,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"execution_count":12,"outputs":[]},{"cell_type":"code","execution_count":13,"metadata":{"id":"TX-5K8GGG-zT","executionInfo":{"status":"ok","timestamp":1677512596759,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["class RemoveTransparency(object):\n","    def __call__(self, sample):\n","      # La imagen se guarda con transparencia, removemos la dimension de indice 3\n","      return sample[0:3, :, :]"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"UmM3wjZ0Qfa4","executionInfo":{"status":"ok","timestamp":1677512596759,"user_tz":180,"elapsed":11,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["class ToLabelOutput(object):\n","    def __call__(self, label):\n","        if label == \"CN\":\n","            return 0\n","        elif label == \"AD\":\n","            return 1\n","        else:\n","            return 2 # MCI, LMCI, EMCI"]},{"cell_type":"code","source":["class ADNIDataset(Dataset):\n","    \"\"\"ADNI dataset.\"\"\"\n","\n","    def __init__(self, name, csv_file, root_dir, transform=None, target_transform = None, \n","                 cacheSize = 200):\n","        \"\"\"\n","        Args:\n","            csv_file (string): Path to the csv file with annotations.\n","            root_dir (string): Directory with all the images.\n","            transform (callable, optional): Optional transform to be applied\n","                on a sample.\n","        \"\"\"\n","        self.name = name\n","        self.csv = pd.read_csv(csv_file)\n","        self.root_dir = root_dir\n","        self.transform = transform\n","        self.target_transform = target_transform\n","        # item_cache directamente almacena los items procesados\n","        self.cacheSize = cacheSize\n","        self.item_cache = [None] * cacheSize\n","        self.cachedItems = 0\n","\n","    def __len__(self):\n","      return int(len(self.csv))\n","\n","    def storeInCache(self, idx, image, label):\n","        if self.cacheSize > 0 and self.item_cache[idx % self.cacheSize] == None:  \n","            logDebug(self.name + \"] Storing item in cache: \" + str(idx))\n","            self.cachedItems += 1\n","            # Storing item in cache\n","            self.item_cache[idx % self.cacheSize] = {\n","                \"id\": idx,\n","                \"label\": label,\n","                \"image\": image\n","            }\n","            logDebug(self.name + \"] Cached items: \" + str(self.cachedItems))\n","\n","    def itemInCache(self, idx):\n","        if self.cacheSize > 0 and self.item_cache[idx % self.cacheSize] != None and self.item_cache[idx % self.cacheSize][\"id\"] == idx:\n","            return self.item_cache[idx % self.cacheSize]\n","        else:\n","            return None\n","\n","    def __getitem__(self, idx):\n","        if torch.is_tensor(idx):\n","            idx = idx.tolist()\n","\n","        if self.itemInCache(idx):\n","            item = self.itemInCache(idx)\n","            return item[\"image\"], item[\"label\"], \n","\n","        studyID = self.csv.iloc[idx, 0]\n","        subjectID = self.csv.iloc[idx, 1]\n","        processFormat = self.csv.iloc[idx, 7]\n","        date = self.csv.iloc[idx, 9]\n","        label = self.csv.iloc[idx, 2]\n","        \n","        if self.transform:\n","            image = self.transform(studyID)\n","            \n","        if self.target_transform:\n","            label = self.target_transform(label)\n","\n","        self.storeInCache(idx, image, label)\n","\n","        return image, label"],"metadata":{"id":"JmEN7Kfc31ge","executionInfo":{"status":"ok","timestamp":1677512596760,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"execution_count":15,"outputs":[]},{"cell_type":"code","execution_count":16,"metadata":{"id":"tMPKNDmqyALS","executionInfo":{"status":"ok","timestamp":1677512596761,"user_tz":180,"elapsed":13,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["def printFile(text, file):\n","  print(text)\n","  if file != None:\n","      file.write(text + \"\\n\")"]},{"cell_type":"markdown","metadata":{"id":"zW1D_vQnpzDk"},"source":["# Modelo"]},{"cell_type":"code","execution_count":17,"metadata":{"id":"m44_ZbqJvsQ9","executionInfo":{"status":"ok","timestamp":1677512596761,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["def train_model(model, dataloaders, criterion, optimizer, num_epochs=25, is_inception=True, logFile = None):\n","    f = None\n","    if logFile != None:\n","        f = open(logFile, \"w\")\n","\n","    since = time.time()\n","\n","    train_acc_history = []\n","    val_acc_history = []\n","    train_loss_history = []\n","    val_loss_history = []\n","\n","    best_model_wts = copy.deepcopy(model.state_dict())\n","    best_acc = 0.0\n","\n","    for epoch in range(num_epochs):\n","        printFile('Epoch {}/{}'.format(epoch, num_epochs - 1), f)\n","        printFile('-' * 10, f)\n","\n","        # Each epoch has a training and validation phase\n","        for phase in ['train', 'val']:\n","            if phase == 'train':\n","                model.train()  # Set model to training mode\n","            else:\n","                model.eval()   # Set model to evaluate mode\n","\n","            running_loss = 0.0\n","            running_corrects = 0\n","            it = 0\n","\n","            # Iterate over data.\n","            for inputs, labels in dataloaders[phase]:\n","                inputs = inputs.to(device)\n","                labels = labels.to(device)\n","\n","                # zero the parameter gradients\n","                optimizer.zero_grad()\n","\n","                # forward\n","                # track history if only in train\n","                with torch.set_grad_enabled(phase == 'train'):\n","                    # Get model outputs and calculate loss\n","                    # Special case for inception because in training it has an auxiliary output. In train\n","                    #   mode we calculate the loss by summing the final output and the auxiliary output\n","                    #   but in testing we only consider the final output.\n","                    if is_inception and phase == 'train':\n","                        # From https://discuss.pytorch.org/t/how-to-optimize-inception-model-with-auxiliary-classifiers/7958\n","                        outputs, aux_outputs = model(inputs)\n","                        if auxEnabled: \n","                          loss1 = criterion(outputs, labels)\n","                          loss2 = criterion(aux_outputs, labels)\n","                          loss = loss1 + 0.4*loss2                          \n","                        else:\n","                          loss = criterion(outputs, labels)\n","                    else:\n","                        outputs = model(inputs)\n","                        loss = criterion(outputs, labels)\n","\n","                    _, preds = torch.max(outputs, 1)\n","\n","                    # backward + optimize only if in training phase\n","                    if phase == 'train':\n","                        loss.backward()\n","                        optimizer.step()\n","\n","                # statistics\n","                running_loss += loss.item() * inputs.size(0)\n","                running_corrects += torch.sum(preds == labels.data)\n","                logDebug(\"Iteration \" + str(it))\n","                it += 1\n","\n","            epoch_loss = running_loss / len(dataloaders[phase].dataset)\n","            epoch_acc = running_corrects.double() / len(dataloaders[phase].dataset)\n","\n","            printFile('{} Loss: {:.4f} Acc: {:.4f}'.format(phase, epoch_loss, epoch_acc), f)\n","\n","            # deep copy the model\n","            if phase == 'val' and epoch_acc > best_acc:\n","                best_acc = epoch_acc\n","                best_model_wts = copy.deepcopy(model.state_dict())\n","            if phase == 'val':\n","                val_acc_history.append(epoch_acc)\n","                val_loss_history.append(epoch_loss)\n","            if phase == 'train':\n","                train_acc_history.append(epoch_acc)\n","                train_loss_history.append(epoch_loss)\n","            \n","\n","    time_elapsed = time.time() - since\n","    printFile('Training complete in {:.0f}m {:.0f}s'.format(time_elapsed // 60, time_elapsed % 60), f)\n","    printFile('Best val Acc: {:4f}'.format(best_acc), f)\n","\n","    # load best model weights\n","    model.load_state_dict(best_model_wts)\n","    if logFile != None:\n","        f.close()\n","    return model, val_acc_history, val_loss_history, train_acc_history, train_loss_history"]},{"cell_type":"code","execution_count":18,"metadata":{"id":"Vl-UuMFJv0_S","executionInfo":{"status":"ok","timestamp":1677512596762,"user_tz":180,"elapsed":13,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["def set_parameter_requires_grad(model, feature_extracting):\n","    if feature_extracting:\n","        for param in model.parameters():\n","            param.requires_grad = False"]},{"cell_type":"markdown","metadata":{"id":"DuMUC0zqwFLw"},"source":["# Initialize and reshape inception"]},{"cell_type":"code","execution_count":40,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1320,"status":"ok","timestamp":1677513261655,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"},"user_tz":180},"id":"GqZfuwYwwLw2","outputId":"bfe76845-201c-4de0-a277-87cb953e2c2f"},"outputs":[{"output_type":"stream","name":"stdout","text":["num featurs2048\n","Inception3(\n","  (Conv2d_1a_3x3): BasicConv2d(\n","    (conv): Conv2d(3, 32, kernel_size=(3, 3), stride=(2, 2), bias=False)\n","    (bn): BatchNorm2d(32, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","  )\n","  (Conv2d_2a_3x3): BasicConv2d(\n","    (conv): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), bias=False)\n","    (bn): BatchNorm2d(32, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","  )\n","  (Conv2d_2b_3x3): BasicConv2d(\n","    (conv): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","    (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","  )\n","  (maxpool1): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)\n","  (Conv2d_3b_1x1): BasicConv2d(\n","    (conv): Conv2d(64, 80, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","    (bn): BatchNorm2d(80, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","  )\n","  (Conv2d_4a_3x3): BasicConv2d(\n","    (conv): Conv2d(80, 192, kernel_size=(3, 3), stride=(1, 1), bias=False)\n","    (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","  )\n","  (maxpool2): MaxPool2d(kernel_size=3, stride=2, padding=0, dilation=1, ceil_mode=False)\n","  (Mixed_5b): InceptionA(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(192, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch5x5_1): BasicConv2d(\n","      (conv): Conv2d(192, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(48, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch5x5_2): BasicConv2d(\n","      (conv): Conv2d(48, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_1): BasicConv2d(\n","      (conv): Conv2d(192, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_2): BasicConv2d(\n","      (conv): Conv2d(64, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3): BasicConv2d(\n","      (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(192, 32, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(32, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_5c): InceptionA(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch5x5_1): BasicConv2d(\n","      (conv): Conv2d(256, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(48, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch5x5_2): BasicConv2d(\n","      (conv): Conv2d(48, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_1): BasicConv2d(\n","      (conv): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_2): BasicConv2d(\n","      (conv): Conv2d(64, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3): BasicConv2d(\n","      (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(256, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_5d): InceptionA(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(288, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch5x5_1): BasicConv2d(\n","      (conv): Conv2d(288, 48, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(48, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch5x5_2): BasicConv2d(\n","      (conv): Conv2d(48, 64, kernel_size=(5, 5), stride=(1, 1), padding=(2, 2), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_1): BasicConv2d(\n","      (conv): Conv2d(288, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_2): BasicConv2d(\n","      (conv): Conv2d(64, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3): BasicConv2d(\n","      (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(288, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_6a): InceptionB(\n","    (branch3x3): BasicConv2d(\n","      (conv): Conv2d(288, 384, kernel_size=(3, 3), stride=(2, 2), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_1): BasicConv2d(\n","      (conv): Conv2d(288, 64, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(64, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_2): BasicConv2d(\n","      (conv): Conv2d(64, 96, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3): BasicConv2d(\n","      (conv): Conv2d(96, 96, kernel_size=(3, 3), stride=(2, 2), bias=False)\n","      (bn): BatchNorm2d(96, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_6b): InceptionC(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_1): BasicConv2d(\n","      (conv): Conv2d(768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_2): BasicConv2d(\n","      (conv): Conv2d(128, 128, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_3): BasicConv2d(\n","      (conv): Conv2d(128, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_1): BasicConv2d(\n","      (conv): Conv2d(768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_2): BasicConv2d(\n","      (conv): Conv2d(128, 128, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_3): BasicConv2d(\n","      (conv): Conv2d(128, 128, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_4): BasicConv2d(\n","      (conv): Conv2d(128, 128, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_5): BasicConv2d(\n","      (conv): Conv2d(128, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_6c): InceptionC(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_1): BasicConv2d(\n","      (conv): Conv2d(768, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_2): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_3): BasicConv2d(\n","      (conv): Conv2d(160, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_1): BasicConv2d(\n","      (conv): Conv2d(768, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_2): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_3): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_4): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_5): BasicConv2d(\n","      (conv): Conv2d(160, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_6d): InceptionC(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_1): BasicConv2d(\n","      (conv): Conv2d(768, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_2): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_3): BasicConv2d(\n","      (conv): Conv2d(160, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_1): BasicConv2d(\n","      (conv): Conv2d(768, 160, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_2): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_3): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_4): BasicConv2d(\n","      (conv): Conv2d(160, 160, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(160, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_5): BasicConv2d(\n","      (conv): Conv2d(160, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_6e): InceptionC(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_2): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7_3): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_2): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_3): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_4): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7dbl_5): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (AuxLogits): InceptionAux(\n","    (conv0): BasicConv2d(\n","      (conv): Conv2d(768, 128, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(128, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (conv1): BasicConv2d(\n","      (conv): Conv2d(128, 768, kernel_size=(5, 5), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(768, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (fc): Sequential(\n","      (0): Linear(in_features=768, out_features=3, bias=True)\n","    )\n","  )\n","  (Mixed_7a): InceptionD(\n","    (branch3x3_1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_2): BasicConv2d(\n","      (conv): Conv2d(192, 320, kernel_size=(3, 3), stride=(2, 2), bias=False)\n","      (bn): BatchNorm2d(320, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7x3_1): BasicConv2d(\n","      (conv): Conv2d(768, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7x3_2): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(1, 7), stride=(1, 1), padding=(0, 3), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7x3_3): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(7, 1), stride=(1, 1), padding=(3, 0), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch7x7x3_4): BasicConv2d(\n","      (conv): Conv2d(192, 192, kernel_size=(3, 3), stride=(2, 2), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_7b): InceptionE(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(1280, 320, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(320, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_1): BasicConv2d(\n","      (conv): Conv2d(1280, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_2a): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_2b): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(3, 1), stride=(1, 1), padding=(1, 0), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_1): BasicConv2d(\n","      (conv): Conv2d(1280, 448, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(448, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_2): BasicConv2d(\n","      (conv): Conv2d(448, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3a): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3b): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(3, 1), stride=(1, 1), padding=(1, 0), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(1280, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (Mixed_7c): InceptionE(\n","    (branch1x1): BasicConv2d(\n","      (conv): Conv2d(2048, 320, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(320, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_1): BasicConv2d(\n","      (conv): Conv2d(2048, 384, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_2a): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3_2b): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(3, 1), stride=(1, 1), padding=(1, 0), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_1): BasicConv2d(\n","      (conv): Conv2d(2048, 448, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(448, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_2): BasicConv2d(\n","      (conv): Conv2d(448, 384, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3a): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch3x3dbl_3b): BasicConv2d(\n","      (conv): Conv2d(384, 384, kernel_size=(3, 1), stride=(1, 1), padding=(1, 0), bias=False)\n","      (bn): BatchNorm2d(384, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","    (branch_pool): BasicConv2d(\n","      (conv): Conv2d(2048, 192, kernel_size=(1, 1), stride=(1, 1), bias=False)\n","      (bn): BatchNorm2d(192, eps=0.001, momentum=0.1, affine=True, track_running_stats=True)\n","    )\n","  )\n","  (avgpool): AdaptiveAvgPool2d(output_size=(1, 1))\n","  (dropout): Dropout(p=0.6, inplace=False)\n","  (fc): Sequential(\n","    (0): Linear(in_features=2048, out_features=1024, bias=True)\n","    (1): ReLU()\n","    (2): Linear(in_features=1024, out_features=3, bias=True)\n","  )\n",")\n"]}],"source":["def initialize_model(model_name, num_classes, feature_extract, use_pretrained=True):\n","    # Initialize these variables which will be set in this if statement. Each of these\n","    #   variables is model specific.\n","    model_ft = None\n","    input_size = 0\n","\n","    if model_name == \"inception\":\n","        \"\"\" Inception v3\n","        Be careful, expects (299,299) sized images and has auxiliary output\n","        \"\"\"\n","        model_ft = models.inception_v3(pretrained=use_pretrained, \n","                                       aux_logits = True)\n","        set_parameter_requires_grad(model_ft, feature_extract)\n","        # Handle the auxilary net\n","        # num_ftrs = model_ft.AuxLogits.fc.in_features\n","        # model_ft.AuxLogits.fc = nn.Linear(num_ftrs, num_classes)\n","        # Handle the primary net\n","        num_ftrs = model_ft.fc.in_features\n","        print(\"num featurs\" + str(num_ftrs))\n","        # Fuente: https://github.com/bdrad/petdementiapub/blob/master/petdementia_source.py\n","        model_ft.dropout = nn.Dropout(dropoutRate)\n","        model_ft.fc = nn.Sequential(\n","          nn.Linear(num_ftrs,1024),\n","          nn.ReLU(),\n","          nn.Linear(1024,num_classes),\n","        )\n","\n","        if auxEnabled :\n","          model_ft.AuxLogits.fc = nn.Sequential(\n","            nn.Linear(768,num_classes), # elegido arbitrariamentoe\n","          )\n","          \n","        input_size = 512 \n","\n","    else:\n","        print(\"Invalid model name, exiting...\")\n","        exit()\n","\n","    return model_ft, input_size\n","\n","# Initialize the model for this run\n","model_ft, input_size = initialize_model(model_name, num_classes, feature_extract, use_pretrained=usePretrained)\n","\n","# Print the model we just instantiated\n","print(model_ft)"]},{"cell_type":"code","execution_count":41,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":24,"status":"ok","timestamp":1677513261655,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"},"user_tz":180},"id":"pfACeWNcwYqY","outputId":"ccb0b5c1-81ad-4be0-d7d5-5b2bf8bc0458"},"outputs":[{"output_type":"stream","name":"stdout","text":["Initializing Datasets and Dataloaders...\n"]}],"source":["# Data augmentation and normalization for training\n","# Just normalization for validation\n","trainGridArgs = dataAugmentation.copy()\n","\n","valGridArgs = {}\n","\n","data_transforms = {\n","    'train': transforms.Compose([\n","        SelectGridImage(**trainGridArgs),\n","        LoadGridImage(),\n","        transforms.ToTensor(),\n","        RemoveTransparency(),\n","        transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])\n","    ]),\n","    'val': transforms.Compose([\n","        SelectGridImage(),\n","        LoadGridImage(),\n","        transforms.ToTensor(),\n","        RemoveTransparency(),\n","        transforms.Normalize([0.485, 0.456, 0.406], [0.229, 0.224, 0.225])\n","    ]),\n","}\n","\n","print(\"Initializing Datasets and Dataloaders...\")\n","\n","# Create training and validation datasets\n","\n","image_datasets = {\n","    'train': ADNIDataset('trainDL', trainDatasetCSV, imagesFolder, transform = data_transforms['train'], target_transform =ToLabelOutput(), cacheSize = trainCacheSize),\n","    'val': ADNIDataset('valDL', valDatasetCSV, imagesFolder, transform = data_transforms['val'], target_transform =ToLabelOutput(), cacheSize = validationCacheSize )\n","}\n","\n","# Create training and validation dataloaders\n","dataloaders_dict = {x: torch.utils.data.DataLoader(image_datasets[x], batch_size=batch_size, shuffle=True, num_workers=dl_num_workers) for x in ['train', 'val']}\n","\n","# Detect if we have a GPU available\n","device = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")"]},{"cell_type":"code","execution_count":42,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":15,"status":"ok","timestamp":1677513261656,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"},"user_tz":180},"id":"XciJ190PwerB","outputId":"a6cd7338-53d8-4367-d49d-a8c750334d57"},"outputs":[{"output_type":"stream","name":"stdout","text":["Params to learn:\n","\t Conv2d_1a_3x3.conv.weight\n","\t Conv2d_1a_3x3.bn.weight\n","\t Conv2d_1a_3x3.bn.bias\n","\t Conv2d_2a_3x3.conv.weight\n","\t Conv2d_2a_3x3.bn.weight\n","\t Conv2d_2a_3x3.bn.bias\n","\t Conv2d_2b_3x3.conv.weight\n","\t Conv2d_2b_3x3.bn.weight\n","\t Conv2d_2b_3x3.bn.bias\n","\t Conv2d_3b_1x1.conv.weight\n","\t Conv2d_3b_1x1.bn.weight\n","\t Conv2d_3b_1x1.bn.bias\n","\t Conv2d_4a_3x3.conv.weight\n","\t Conv2d_4a_3x3.bn.weight\n","\t Conv2d_4a_3x3.bn.bias\n","\t Mixed_5b.branch1x1.conv.weight\n","\t Mixed_5b.branch1x1.bn.weight\n","\t Mixed_5b.branch1x1.bn.bias\n","\t Mixed_5b.branch5x5_1.conv.weight\n","\t Mixed_5b.branch5x5_1.bn.weight\n","\t Mixed_5b.branch5x5_1.bn.bias\n","\t Mixed_5b.branch5x5_2.conv.weight\n","\t Mixed_5b.branch5x5_2.bn.weight\n","\t Mixed_5b.branch5x5_2.bn.bias\n","\t Mixed_5b.branch3x3dbl_1.conv.weight\n","\t Mixed_5b.branch3x3dbl_1.bn.weight\n","\t Mixed_5b.branch3x3dbl_1.bn.bias\n","\t Mixed_5b.branch3x3dbl_2.conv.weight\n","\t Mixed_5b.branch3x3dbl_2.bn.weight\n","\t Mixed_5b.branch3x3dbl_2.bn.bias\n","\t Mixed_5b.branch3x3dbl_3.conv.weight\n","\t Mixed_5b.branch3x3dbl_3.bn.weight\n","\t Mixed_5b.branch3x3dbl_3.bn.bias\n","\t Mixed_5b.branch_pool.conv.weight\n","\t Mixed_5b.branch_pool.bn.weight\n","\t Mixed_5b.branch_pool.bn.bias\n","\t Mixed_5c.branch1x1.conv.weight\n","\t Mixed_5c.branch1x1.bn.weight\n","\t Mixed_5c.branch1x1.bn.bias\n","\t Mixed_5c.branch5x5_1.conv.weight\n","\t Mixed_5c.branch5x5_1.bn.weight\n","\t Mixed_5c.branch5x5_1.bn.bias\n","\t Mixed_5c.branch5x5_2.conv.weight\n","\t Mixed_5c.branch5x5_2.bn.weight\n","\t Mixed_5c.branch5x5_2.bn.bias\n","\t Mixed_5c.branch3x3dbl_1.conv.weight\n","\t Mixed_5c.branch3x3dbl_1.bn.weight\n","\t Mixed_5c.branch3x3dbl_1.bn.bias\n","\t Mixed_5c.branch3x3dbl_2.conv.weight\n","\t Mixed_5c.branch3x3dbl_2.bn.weight\n","\t Mixed_5c.branch3x3dbl_2.bn.bias\n","\t Mixed_5c.branch3x3dbl_3.conv.weight\n","\t Mixed_5c.branch3x3dbl_3.bn.weight\n","\t Mixed_5c.branch3x3dbl_3.bn.bias\n","\t Mixed_5c.branch_pool.conv.weight\n","\t Mixed_5c.branch_pool.bn.weight\n","\t Mixed_5c.branch_pool.bn.bias\n","\t Mixed_5d.branch1x1.conv.weight\n","\t Mixed_5d.branch1x1.bn.weight\n","\t Mixed_5d.branch1x1.bn.bias\n","\t Mixed_5d.branch5x5_1.conv.weight\n","\t Mixed_5d.branch5x5_1.bn.weight\n","\t Mixed_5d.branch5x5_1.bn.bias\n","\t Mixed_5d.branch5x5_2.conv.weight\n","\t Mixed_5d.branch5x5_2.bn.weight\n","\t Mixed_5d.branch5x5_2.bn.bias\n","\t Mixed_5d.branch3x3dbl_1.conv.weight\n","\t Mixed_5d.branch3x3dbl_1.bn.weight\n","\t Mixed_5d.branch3x3dbl_1.bn.bias\n","\t Mixed_5d.branch3x3dbl_2.conv.weight\n","\t Mixed_5d.branch3x3dbl_2.bn.weight\n","\t Mixed_5d.branch3x3dbl_2.bn.bias\n","\t Mixed_5d.branch3x3dbl_3.conv.weight\n","\t Mixed_5d.branch3x3dbl_3.bn.weight\n","\t Mixed_5d.branch3x3dbl_3.bn.bias\n","\t Mixed_5d.branch_pool.conv.weight\n","\t Mixed_5d.branch_pool.bn.weight\n","\t Mixed_5d.branch_pool.bn.bias\n","\t Mixed_6a.branch3x3.conv.weight\n","\t Mixed_6a.branch3x3.bn.weight\n","\t Mixed_6a.branch3x3.bn.bias\n","\t Mixed_6a.branch3x3dbl_1.conv.weight\n","\t Mixed_6a.branch3x3dbl_1.bn.weight\n","\t Mixed_6a.branch3x3dbl_1.bn.bias\n","\t Mixed_6a.branch3x3dbl_2.conv.weight\n","\t Mixed_6a.branch3x3dbl_2.bn.weight\n","\t Mixed_6a.branch3x3dbl_2.bn.bias\n","\t Mixed_6a.branch3x3dbl_3.conv.weight\n","\t Mixed_6a.branch3x3dbl_3.bn.weight\n","\t Mixed_6a.branch3x3dbl_3.bn.bias\n","\t Mixed_6b.branch1x1.conv.weight\n","\t Mixed_6b.branch1x1.bn.weight\n","\t Mixed_6b.branch1x1.bn.bias\n","\t Mixed_6b.branch7x7_1.conv.weight\n","\t Mixed_6b.branch7x7_1.bn.weight\n","\t Mixed_6b.branch7x7_1.bn.bias\n","\t Mixed_6b.branch7x7_2.conv.weight\n","\t Mixed_6b.branch7x7_2.bn.weight\n","\t Mixed_6b.branch7x7_2.bn.bias\n","\t Mixed_6b.branch7x7_3.conv.weight\n","\t Mixed_6b.branch7x7_3.bn.weight\n","\t Mixed_6b.branch7x7_3.bn.bias\n","\t Mixed_6b.branch7x7dbl_1.conv.weight\n","\t Mixed_6b.branch7x7dbl_1.bn.weight\n","\t Mixed_6b.branch7x7dbl_1.bn.bias\n","\t Mixed_6b.branch7x7dbl_2.conv.weight\n","\t Mixed_6b.branch7x7dbl_2.bn.weight\n","\t Mixed_6b.branch7x7dbl_2.bn.bias\n","\t Mixed_6b.branch7x7dbl_3.conv.weight\n","\t Mixed_6b.branch7x7dbl_3.bn.weight\n","\t Mixed_6b.branch7x7dbl_3.bn.bias\n","\t Mixed_6b.branch7x7dbl_4.conv.weight\n","\t Mixed_6b.branch7x7dbl_4.bn.weight\n","\t Mixed_6b.branch7x7dbl_4.bn.bias\n","\t Mixed_6b.branch7x7dbl_5.conv.weight\n","\t Mixed_6b.branch7x7dbl_5.bn.weight\n","\t Mixed_6b.branch7x7dbl_5.bn.bias\n","\t Mixed_6b.branch_pool.conv.weight\n","\t Mixed_6b.branch_pool.bn.weight\n","\t Mixed_6b.branch_pool.bn.bias\n","\t Mixed_6c.branch1x1.conv.weight\n","\t Mixed_6c.branch1x1.bn.weight\n","\t Mixed_6c.branch1x1.bn.bias\n","\t Mixed_6c.branch7x7_1.conv.weight\n","\t Mixed_6c.branch7x7_1.bn.weight\n","\t Mixed_6c.branch7x7_1.bn.bias\n","\t Mixed_6c.branch7x7_2.conv.weight\n","\t Mixed_6c.branch7x7_2.bn.weight\n","\t Mixed_6c.branch7x7_2.bn.bias\n","\t Mixed_6c.branch7x7_3.conv.weight\n","\t Mixed_6c.branch7x7_3.bn.weight\n","\t Mixed_6c.branch7x7_3.bn.bias\n","\t Mixed_6c.branch7x7dbl_1.conv.weight\n","\t Mixed_6c.branch7x7dbl_1.bn.weight\n","\t Mixed_6c.branch7x7dbl_1.bn.bias\n","\t Mixed_6c.branch7x7dbl_2.conv.weight\n","\t Mixed_6c.branch7x7dbl_2.bn.weight\n","\t Mixed_6c.branch7x7dbl_2.bn.bias\n","\t Mixed_6c.branch7x7dbl_3.conv.weight\n","\t Mixed_6c.branch7x7dbl_3.bn.weight\n","\t Mixed_6c.branch7x7dbl_3.bn.bias\n","\t Mixed_6c.branch7x7dbl_4.conv.weight\n","\t Mixed_6c.branch7x7dbl_4.bn.weight\n","\t Mixed_6c.branch7x7dbl_4.bn.bias\n","\t Mixed_6c.branch7x7dbl_5.conv.weight\n","\t Mixed_6c.branch7x7dbl_5.bn.weight\n","\t Mixed_6c.branch7x7dbl_5.bn.bias\n","\t Mixed_6c.branch_pool.conv.weight\n","\t Mixed_6c.branch_pool.bn.weight\n","\t Mixed_6c.branch_pool.bn.bias\n","\t Mixed_6d.branch1x1.conv.weight\n","\t Mixed_6d.branch1x1.bn.weight\n","\t Mixed_6d.branch1x1.bn.bias\n","\t Mixed_6d.branch7x7_1.conv.weight\n","\t Mixed_6d.branch7x7_1.bn.weight\n","\t Mixed_6d.branch7x7_1.bn.bias\n","\t Mixed_6d.branch7x7_2.conv.weight\n","\t Mixed_6d.branch7x7_2.bn.weight\n","\t Mixed_6d.branch7x7_2.bn.bias\n","\t Mixed_6d.branch7x7_3.conv.weight\n","\t Mixed_6d.branch7x7_3.bn.weight\n","\t Mixed_6d.branch7x7_3.bn.bias\n","\t Mixed_6d.branch7x7dbl_1.conv.weight\n","\t Mixed_6d.branch7x7dbl_1.bn.weight\n","\t Mixed_6d.branch7x7dbl_1.bn.bias\n","\t Mixed_6d.branch7x7dbl_2.conv.weight\n","\t Mixed_6d.branch7x7dbl_2.bn.weight\n","\t Mixed_6d.branch7x7dbl_2.bn.bias\n","\t Mixed_6d.branch7x7dbl_3.conv.weight\n","\t Mixed_6d.branch7x7dbl_3.bn.weight\n","\t Mixed_6d.branch7x7dbl_3.bn.bias\n","\t Mixed_6d.branch7x7dbl_4.conv.weight\n","\t Mixed_6d.branch7x7dbl_4.bn.weight\n","\t Mixed_6d.branch7x7dbl_4.bn.bias\n","\t Mixed_6d.branch7x7dbl_5.conv.weight\n","\t Mixed_6d.branch7x7dbl_5.bn.weight\n","\t Mixed_6d.branch7x7dbl_5.bn.bias\n","\t Mixed_6d.branch_pool.conv.weight\n","\t Mixed_6d.branch_pool.bn.weight\n","\t Mixed_6d.branch_pool.bn.bias\n","\t Mixed_6e.branch1x1.conv.weight\n","\t Mixed_6e.branch1x1.bn.weight\n","\t Mixed_6e.branch1x1.bn.bias\n","\t Mixed_6e.branch7x7_1.conv.weight\n","\t Mixed_6e.branch7x7_1.bn.weight\n","\t Mixed_6e.branch7x7_1.bn.bias\n","\t Mixed_6e.branch7x7_2.conv.weight\n","\t Mixed_6e.branch7x7_2.bn.weight\n","\t Mixed_6e.branch7x7_2.bn.bias\n","\t Mixed_6e.branch7x7_3.conv.weight\n","\t Mixed_6e.branch7x7_3.bn.weight\n","\t Mixed_6e.branch7x7_3.bn.bias\n","\t Mixed_6e.branch7x7dbl_1.conv.weight\n","\t Mixed_6e.branch7x7dbl_1.bn.weight\n","\t Mixed_6e.branch7x7dbl_1.bn.bias\n","\t Mixed_6e.branch7x7dbl_2.conv.weight\n","\t Mixed_6e.branch7x7dbl_2.bn.weight\n","\t Mixed_6e.branch7x7dbl_2.bn.bias\n","\t Mixed_6e.branch7x7dbl_3.conv.weight\n","\t Mixed_6e.branch7x7dbl_3.bn.weight\n","\t Mixed_6e.branch7x7dbl_3.bn.bias\n","\t Mixed_6e.branch7x7dbl_4.conv.weight\n","\t Mixed_6e.branch7x7dbl_4.bn.weight\n","\t Mixed_6e.branch7x7dbl_4.bn.bias\n","\t Mixed_6e.branch7x7dbl_5.conv.weight\n","\t Mixed_6e.branch7x7dbl_5.bn.weight\n","\t Mixed_6e.branch7x7dbl_5.bn.bias\n","\t Mixed_6e.branch_pool.conv.weight\n","\t Mixed_6e.branch_pool.bn.weight\n","\t Mixed_6e.branch_pool.bn.bias\n","\t AuxLogits.conv0.conv.weight\n","\t AuxLogits.conv0.bn.weight\n","\t AuxLogits.conv0.bn.bias\n","\t AuxLogits.conv1.conv.weight\n","\t AuxLogits.conv1.bn.weight\n","\t AuxLogits.conv1.bn.bias\n","\t AuxLogits.fc.0.weight\n","\t AuxLogits.fc.0.bias\n","\t Mixed_7a.branch3x3_1.conv.weight\n","\t Mixed_7a.branch3x3_1.bn.weight\n","\t Mixed_7a.branch3x3_1.bn.bias\n","\t Mixed_7a.branch3x3_2.conv.weight\n","\t Mixed_7a.branch3x3_2.bn.weight\n","\t Mixed_7a.branch3x3_2.bn.bias\n","\t Mixed_7a.branch7x7x3_1.conv.weight\n","\t Mixed_7a.branch7x7x3_1.bn.weight\n","\t Mixed_7a.branch7x7x3_1.bn.bias\n","\t Mixed_7a.branch7x7x3_2.conv.weight\n","\t Mixed_7a.branch7x7x3_2.bn.weight\n","\t Mixed_7a.branch7x7x3_2.bn.bias\n","\t Mixed_7a.branch7x7x3_3.conv.weight\n","\t Mixed_7a.branch7x7x3_3.bn.weight\n","\t Mixed_7a.branch7x7x3_3.bn.bias\n","\t Mixed_7a.branch7x7x3_4.conv.weight\n","\t Mixed_7a.branch7x7x3_4.bn.weight\n","\t Mixed_7a.branch7x7x3_4.bn.bias\n","\t Mixed_7b.branch1x1.conv.weight\n","\t Mixed_7b.branch1x1.bn.weight\n","\t Mixed_7b.branch1x1.bn.bias\n","\t Mixed_7b.branch3x3_1.conv.weight\n","\t Mixed_7b.branch3x3_1.bn.weight\n","\t Mixed_7b.branch3x3_1.bn.bias\n","\t Mixed_7b.branch3x3_2a.conv.weight\n","\t Mixed_7b.branch3x3_2a.bn.weight\n","\t Mixed_7b.branch3x3_2a.bn.bias\n","\t Mixed_7b.branch3x3_2b.conv.weight\n","\t Mixed_7b.branch3x3_2b.bn.weight\n","\t Mixed_7b.branch3x3_2b.bn.bias\n","\t Mixed_7b.branch3x3dbl_1.conv.weight\n","\t Mixed_7b.branch3x3dbl_1.bn.weight\n","\t Mixed_7b.branch3x3dbl_1.bn.bias\n","\t Mixed_7b.branch3x3dbl_2.conv.weight\n","\t Mixed_7b.branch3x3dbl_2.bn.weight\n","\t Mixed_7b.branch3x3dbl_2.bn.bias\n","\t Mixed_7b.branch3x3dbl_3a.conv.weight\n","\t Mixed_7b.branch3x3dbl_3a.bn.weight\n","\t Mixed_7b.branch3x3dbl_3a.bn.bias\n","\t Mixed_7b.branch3x3dbl_3b.conv.weight\n","\t Mixed_7b.branch3x3dbl_3b.bn.weight\n","\t Mixed_7b.branch3x3dbl_3b.bn.bias\n","\t Mixed_7b.branch_pool.conv.weight\n","\t Mixed_7b.branch_pool.bn.weight\n","\t Mixed_7b.branch_pool.bn.bias\n","\t Mixed_7c.branch1x1.conv.weight\n","\t Mixed_7c.branch1x1.bn.weight\n","\t Mixed_7c.branch1x1.bn.bias\n","\t Mixed_7c.branch3x3_1.conv.weight\n","\t Mixed_7c.branch3x3_1.bn.weight\n","\t Mixed_7c.branch3x3_1.bn.bias\n","\t Mixed_7c.branch3x3_2a.conv.weight\n","\t Mixed_7c.branch3x3_2a.bn.weight\n","\t Mixed_7c.branch3x3_2a.bn.bias\n","\t Mixed_7c.branch3x3_2b.conv.weight\n","\t Mixed_7c.branch3x3_2b.bn.weight\n","\t Mixed_7c.branch3x3_2b.bn.bias\n","\t Mixed_7c.branch3x3dbl_1.conv.weight\n","\t Mixed_7c.branch3x3dbl_1.bn.weight\n","\t Mixed_7c.branch3x3dbl_1.bn.bias\n","\t Mixed_7c.branch3x3dbl_2.conv.weight\n","\t Mixed_7c.branch3x3dbl_2.bn.weight\n","\t Mixed_7c.branch3x3dbl_2.bn.bias\n","\t Mixed_7c.branch3x3dbl_3a.conv.weight\n","\t Mixed_7c.branch3x3dbl_3a.bn.weight\n","\t Mixed_7c.branch3x3dbl_3a.bn.bias\n","\t Mixed_7c.branch3x3dbl_3b.conv.weight\n","\t Mixed_7c.branch3x3dbl_3b.bn.weight\n","\t Mixed_7c.branch3x3dbl_3b.bn.bias\n","\t Mixed_7c.branch_pool.conv.weight\n","\t Mixed_7c.branch_pool.bn.weight\n","\t Mixed_7c.branch_pool.bn.bias\n","\t fc.0.weight\n","\t fc.0.bias\n","\t fc.2.weight\n","\t fc.2.bias\n"]}],"source":["# Send the model to GPU\n","model_ft = model_ft.to(device)\n","\n","# Gather the parameters to be optimized/updated in this run. If we are\n","#  finetuning we will be updating all parameters. However, if we are\n","#  doing feature extract method, we will only update the parameters\n","#  that we have just initialized, i.e. the parameters with requires_grad\n","#  is True.\n","params_to_update = model_ft.parameters()\n","print(\"Params to learn:\")\n","if feature_extract:\n","    params_to_update = []\n","    for name,param in model_ft.named_parameters():\n","        if param.requires_grad == True:\n","            params_to_update.append(param)\n","            print(\"\\t\",name)\n","else:\n","    for name,param in model_ft.named_parameters():\n","        if param.requires_grad == True:\n","            print(\"\\t\",name)\n","\n","# Observe that all parameters are being optimized\n","optimizer_ft = optim.Adam(params_to_update, lr=learningRate)\n"]},{"cell_type":"code","execution_count":43,"metadata":{"id":"CVJl5AvUqK13","executionInfo":{"status":"ok","timestamp":1677513261656,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["def test_model(model,dataloaders,device):\n","    classStats = [{\n","        'fn': 0,\n","        'tn': 0,\n","        'tp': 0,\n","        'fp': 0,\n","        'n': 0,\n","    } for i in range(num_classes)]\n","    correctlyPredicted = 0\n","    n = 0\n","    model.eval()\n","    with torch.no_grad():\n","        for inputs, labels in dataloaders['val']:\n","            inputs = inputs.to(device)\n","            labels = labels.to(device)\n","            outputs = model(inputs)\n","            _, preds = torch.max(outputs, 1)\n","            \n","            # Iteramos para chequear estadisticas\n","            for i, correctClass in enumerate(labels.data):\n","              n += 1\n","              predictedClass = int(preds[i].item())\n","              correctClass = int(correctClass.item())\n","              classStats[correctClass]['n'] += 1\n","              if correctClass == predictedClass:\n","                  correctlyPredicted += 1\n","                  classStats[correctClass]['tp'] += 1\n","                  for i in range(num_classes):\n","                      if i != correctClass:\n","                          classStats[correctClass]['tn'] += 1\n","              else:\n","                  classStats[correctClass]['fn'] += 1\n","                  classStats[predictedClass]['fp'] += 1\n","                  for i in range(num_classes):\n","                      if i != correctClass and i != predictedClass:\n","                          classStats[correctClass]['tn'] += 1\n","    accuracy = correctlyPredicted * 1.0 / n\n","    return classStats, accuracy"]},{"cell_type":"code","execution_count":44,"metadata":{"id":"aK3auwSS05Le","executionInfo":{"status":"ok","timestamp":1677513261656,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[],"source":["def printClassStats(stats):\n","  recall = sensitivity = stats['tp'] / (stats['tp'] + stats['fn']) # prob positive test result\n","  specificity = stats['tn'] / (stats['tn'] + stats['fp'])          # prob negative test result\n","  if stats['tp'] + stats['fp'] > 0:\n","    precision = stats['tp'] / (stats['tp'] + stats['fp'])          # prob of recognized positive actually correct\n","  else:\n","    precision = 1\n","    printFile(\"Setting precision as 1 but no positive value has been reported, so this is placeholder\", f)\n","  if precision + recall == 0:\n","    printFile(\"Setting f1 as 0 because precision + recall is ZERO\", f)\n","    f1 = 0.0\n","  else:\n","    f1 = 2 * (precision * recall) / ( precision + recall )\n","  printFile(\"Sensitivity (%): \" + str(round(sensitivity * 100)), f)\n","  printFile(\"Specificity (%): \" + str(round(specificity * 100)), f)\n","  printFile(\"Precision  (%): \" + str(round(precision * 100)), f)\n","  printFile(\"F1 Score  (%): \" + str(round(f1 * 100)), f)\n","  printFile(\"Number of images: \" + str(stats['n']), f)\n","  return recall, specificity, precision, f1"]},{"cell_type":"code","source":["# loading cache\n","#dataloaders_dict['train'].num_workers = 0\n","#dataloaders_dict['val'].num_workers = 0\n","\n","#for idx, (x, y) in enumerate(dataloaders_dict['train']):\n","#    print(f\"Loading Cache {idx*batch_size}.\\r\", end='')\n","\n","#for idx, (x, y) in enumerate(dataloaders_dict['val']):\n","#    print(f\"Loading Cache {idx*batch_size}.\\r\", end='')\n","\n","#dataloaders_dict['train'].num_workers = dl_num_workers\n","#dataloaders_dict['val'].num_workers = dl_num_workers"],"metadata":{"id":"Bp5X2oNCki65","executionInfo":{"status":"ok","timestamp":1677513261657,"user_tz":180,"elapsed":13,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"execution_count":45,"outputs":[]},{"cell_type":"code","execution_count":46,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":1000},"id":"D84am68jwlX6","outputId":"1e9d5ca1-7f27-4775-b96e-541c73e98887","executionInfo":{"status":"ok","timestamp":1677514081791,"user_tz":180,"elapsed":820145,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}}},"outputs":[{"output_type":"stream","name":"stdout","text":["--- Execution 0 begin ---\n","Epoch 0/49\n","----------\n","train Loss: 1.4355 Acc: 0.4254\n","val Loss: 1.0100 Acc: 0.5267\n","Epoch 1/49\n","----------\n","train Loss: 1.1089 Acc: 0.6317\n","val Loss: 0.9792 Acc: 0.5567\n","Epoch 2/49\n","----------\n","train Loss: 0.8576 Acc: 0.7381\n","val Loss: 1.1470 Acc: 0.4833\n","Epoch 3/49\n","----------\n","train Loss: 0.6419 Acc: 0.8190\n","val Loss: 1.4054 Acc: 0.4833\n","Epoch 4/49\n","----------\n","train Loss: 0.6059 Acc: 0.8190\n","val Loss: 1.1641 Acc: 0.5333\n","Epoch 5/49\n","----------\n","train Loss: 0.3616 Acc: 0.8889\n","val Loss: 1.6924 Acc: 0.4400\n","Epoch 6/49\n","----------\n","train Loss: 0.2828 Acc: 0.9270\n","val Loss: 2.0251 Acc: 0.5067\n","Epoch 7/49\n","----------\n","train Loss: 0.3499 Acc: 0.8921\n","val Loss: 1.7037 Acc: 0.5167\n","Epoch 8/49\n","----------\n","train Loss: 0.2526 Acc: 0.9333\n","val Loss: 1.6271 Acc: 0.5533\n","Epoch 9/49\n","----------\n","train Loss: 0.2670 Acc: 0.9222\n","val Loss: 2.5107 Acc: 0.4233\n","Epoch 10/49\n","----------\n","train Loss: 0.2943 Acc: 0.9175\n","val Loss: 2.0404 Acc: 0.4633\n","Epoch 11/49\n","----------\n","train Loss: 0.2598 Acc: 0.9270\n","val Loss: 1.6827 Acc: 0.5133\n","Epoch 12/49\n","----------\n","train Loss: 0.2084 Acc: 0.9429\n","val Loss: 1.9708 Acc: 0.5133\n","Epoch 13/49\n","----------\n","train Loss: 0.1619 Acc: 0.9603\n","val Loss: 2.6477 Acc: 0.4867\n","Epoch 14/49\n","----------\n","train Loss: 0.2200 Acc: 0.9429\n","val Loss: 2.9587 Acc: 0.4433\n","Epoch 15/49\n","----------\n","train Loss: 0.1583 Acc: 0.9635\n","val Loss: 2.4408 Acc: 0.4900\n","Epoch 16/49\n","----------\n","train Loss: 0.1848 Acc: 0.9508\n","val Loss: 2.5090 Acc: 0.4633\n","Epoch 17/49\n","----------\n","train Loss: 0.1413 Acc: 0.9556\n","val Loss: 2.1276 Acc: 0.4733\n","Epoch 18/49\n","----------\n","train Loss: 0.2209 Acc: 0.9540\n","val Loss: 1.8626 Acc: 0.5167\n","Epoch 19/49\n","----------\n","train Loss: 0.1288 Acc: 0.9810\n","val Loss: 1.7238 Acc: 0.6200\n","Epoch 20/49\n","----------\n","train Loss: 0.1960 Acc: 0.9540\n","val Loss: 1.9271 Acc: 0.4400\n","Epoch 21/49\n","----------\n","train Loss: 0.1832 Acc: 0.9571\n","val Loss: 2.0359 Acc: 0.5767\n","Epoch 22/49\n","----------\n","train Loss: 0.0788 Acc: 0.9857\n","val Loss: 2.2916 Acc: 0.4667\n","Epoch 23/49\n","----------\n","train Loss: 0.1150 Acc: 0.9746\n","val Loss: 2.8052 Acc: 0.5500\n","Epoch 24/49\n","----------\n","train Loss: 0.1218 Acc: 0.9730\n","val Loss: 2.2716 Acc: 0.4567\n","Epoch 25/49\n","----------\n","train Loss: 0.1511 Acc: 0.9571\n","val Loss: 1.8676 Acc: 0.4967\n","Epoch 26/49\n","----------\n","train Loss: 0.1763 Acc: 0.9571\n","val Loss: 2.3004 Acc: 0.4433\n","Epoch 27/49\n","----------\n","train Loss: 0.1143 Acc: 0.9683\n","val Loss: 1.9499 Acc: 0.5600\n","Epoch 28/49\n","----------\n","train Loss: 0.1390 Acc: 0.9587\n","val Loss: 2.4843 Acc: 0.4233\n","Epoch 29/49\n","----------\n","train Loss: 0.2008 Acc: 0.9444\n","val Loss: 1.7769 Acc: 0.5300\n","Epoch 30/49\n","----------\n","train Loss: 0.1132 Acc: 0.9683\n","val Loss: 2.4511 Acc: 0.4900\n","Epoch 31/49\n","----------\n","train Loss: 0.1045 Acc: 0.9714\n","val Loss: 2.2526 Acc: 0.5367\n","Epoch 32/49\n","----------\n","train Loss: 0.0773 Acc: 0.9746\n","val Loss: 2.7119 Acc: 0.4400\n","Epoch 33/49\n","----------\n","train Loss: 0.1461 Acc: 0.9603\n","val Loss: 2.0172 Acc: 0.5333\n","Epoch 34/49\n","----------\n","train Loss: 0.0875 Acc: 0.9810\n","val Loss: 2.1614 Acc: 0.5433\n","Epoch 35/49\n","----------\n","train Loss: 0.1078 Acc: 0.9762\n","val Loss: 2.0877 Acc: 0.4400\n","Epoch 36/49\n","----------\n","train Loss: 0.0762 Acc: 0.9825\n","val Loss: 2.4358 Acc: 0.5800\n","Epoch 37/49\n","----------\n","train Loss: 0.0548 Acc: 0.9841\n","val Loss: 2.0289 Acc: 0.4800\n","Epoch 38/49\n","----------\n","train Loss: 0.0824 Acc: 0.9762\n","val Loss: 2.0384 Acc: 0.5567\n","Epoch 39/49\n","----------\n","train Loss: 0.0786 Acc: 0.9762\n","val Loss: 2.3122 Acc: 0.5367\n","Epoch 40/49\n","----------\n","train Loss: 0.0956 Acc: 0.9841\n","val Loss: 4.0469 Acc: 0.4333\n","Epoch 41/49\n","----------\n","train Loss: 0.0838 Acc: 0.9841\n","val Loss: 1.9761 Acc: 0.5133\n","Epoch 42/49\n","----------\n","train Loss: 0.0724 Acc: 0.9810\n","val Loss: 2.4067 Acc: 0.5233\n","Epoch 43/49\n","----------\n","train Loss: 0.0646 Acc: 0.9825\n","val Loss: 2.5117 Acc: 0.6300\n","Epoch 44/49\n","----------\n","train Loss: 0.0564 Acc: 0.9841\n","val Loss: 2.3287 Acc: 0.5133\n","Epoch 45/49\n","----------\n","train Loss: 0.0503 Acc: 0.9857\n","val Loss: 2.4923 Acc: 0.5300\n","Epoch 46/49\n","----------\n","train Loss: 0.0524 Acc: 0.9857\n","val Loss: 2.8218 Acc: 0.5767\n","Epoch 47/49\n","----------\n","train Loss: 0.0748 Acc: 0.9794\n","val Loss: 2.6270 Acc: 0.6000\n","Epoch 48/49\n","----------\n","train Loss: 0.0984 Acc: 0.9778\n","val Loss: 2.2766 Acc: 0.4800\n","Epoch 49/49\n","----------\n","train Loss: 0.1407 Acc: 0.9651\n","val Loss: 2.9310 Acc: 0.5100\n","Training complete in 13m 36s\n","Best val Acc: 0.630000\n","accuracy: 0.63\n","CN stats: \n","Sensitivity (%): 87\n","Specificity (%): 79\n","Precision  (%): 64\n","F1 Score  (%): 74\n","Number of images: 100\n","\n","AD stats: \n","Sensitivity (%): 82\n","Specificity (%): 78\n","Precision  (%): 62\n","F1 Score  (%): 70\n","Number of images: 100\n","\n","MCI stats: \n","Sensitivity (%): 20\n","Specificity (%): 92\n","Precision  (%): 65\n","F1 Score  (%): 31\n","Number of images: 100\n","--- Execution End ---\n"]},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 0 Axes>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 0 Axes>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 0 Axes>"]},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 0 Axes>"]},"metadata":{}}],"source":["accuracyValues = []\n","adStatValues = []\n","cnStatValues = []\n","mciStatValues = []\n","for i in range(0, executions):\n","    experimentExecutionName = experimentName + '_' + str(i)\n","    print(\"--- Execution \" + str(i) + \" begin ---\")\n","    # Setup the loss fxn\n","    crossEntrophyWeigths = crossEntrophyWeigths.to(device)\n","    criterion = nn.CrossEntropyLoss(crossEntrophyWeigths)\n","\n","    logFile = os.path.join(experimentOutputFolder, experimentExecutionName + '_train.log')\n","\n","    # Train and evaluate\n","    model_ft, val_acc_hist, val_loss_hist, train_acc_hist, train_loss_hist = train_model(model_ft, dataloaders_dict, criterion, optimizer_ft, num_epochs=num_epochs, is_inception=(model_name==\"inception\"), logFile = logFile)\n","\n","    torch.save(model_ft.state_dict(), os.path.join(experimentOutputFolder, experimentExecutionName + '.pth'))\n","\n","    # validation accuracy\n","    fig = plt.figure()\n","    lst = [ x.cpu().item() for x in val_acc_hist ]\n","    plt.plot(lst)\n","    ax = plt.gca()\n","    plt.text(0.05, 0.9, 'FE = ' + str(feature_extract), transform=ax.transAxes)\n","    plt.text(0.05, 0.8, 'LR = ' + str(learningRate), transform=ax.transAxes)\n","    plt.text(0.05, 0.7, 'batch = ' + str(batch_size), transform=ax.transAxes)\n","    plt.suptitle(experimentExecutionName + ' (acc set de validacion)')\n","    plt.ylabel('Accuracy')\n","    plt.xlabel('Epochs')\n","    plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_val_acc.png'))\n","    plt.clf()\n","\n","    # validation loss\n","    fig = plt.figure()\n","    plt.plot(val_loss_hist)\n","    ax = plt.gca()\n","    plt.text(0.05, 0.3, 'FE = ' + str(feature_extract), transform=ax.transAxes)\n","    plt.text(0.05, 0.2, 'LR = ' + str(learningRate), transform=ax.transAxes)\n","    plt.text(0.05, 0.1, 'batch = ' + str(batch_size), transform=ax.transAxes)\n","    plt.suptitle(experimentExecutionName + ' (loss set de validacion)')\n","    plt.ylabel('Loss')\n","    plt.xlabel('Epochs')\n","    plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_val_loss.png'))\n","    plt.clf()\n","\n","    # train accuracy\n","    fig = plt.figure()\n","    lst = [ x.cpu().item() for x in train_acc_hist ]\n","    ax = plt.gca()\n","    plt.text(0.05, 0.9, 'FE = ' + str(feature_extract), transform=ax.transAxes)\n","    plt.text(0.05, 0.8, 'LR = ' + str(learningRate), transform=ax.transAxes)\n","    plt.text(0.05, 0.7, 'batch = ' + str(batch_size), transform=ax.transAxes)\n","    plt.plot(lst)\n","    plt.suptitle(experimentExecutionName + ' (accuracy set de train)')\n","    plt.ylabel('Accuracy')\n","    plt.xlabel('Epochs')\n","    plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_train_acc.png'))\n","    plt.clf()\n","\n","    # train loss\n","    fig = plt.figure()\n","    ax = plt.gca()\n","    plt.text(0.05, 0.3, 'FE = ' + str(feature_extract), transform=ax.transAxes)\n","    plt.text(0.05, 0.2, 'LR = ' + str(learningRate), transform=ax.transAxes)\n","    plt.text(0.05, 0.1, 'batch = ' + str(batch_size), transform=ax.transAxes)\n","    plt.plot(train_loss_hist)\n","    plt.suptitle(experimentExecutionName + ' (Loss set de train)')\n","    plt.ylabel('Loss')\n","    plt.xlabel('Epochs')\n","    plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_train_loss.png'))\n","    plt.clf()\n","\n","    stats, accuracy = test_model(model_ft, dataloaders_dict, device)\n","\n","    print(\"accuracy: \" + str(accuracy))\n","    accuracyValues.append(accuracy)\n","\n","    f = open(os.path.join(experimentOutputFolder, experimentExecutionName + \"_stats.txt\"), \"w\")\n","    printFile(\"CN stats: \", f)\n","    recall, specificity, precision, f1 = printClassStats(stats[0])\n","    cnStatValues.append({\n","        \"recall\": recall,\n","        \"specificity\": specificity,\n","        \"precision\": precision,\n","        \"f1\": f1\n","    })\n","    # AD\n","    printFile(\"\\nAD stats: \", f)\n","    recall, specificity, precision, f1 = printClassStats(stats[1])\n","    adStatValues.append({\n","        \"recall\": recall,\n","        \"specificity\": specificity,\n","        \"precision\": precision,\n","        \"f1\": f1\n","    })\n","    # MCI\n","    printFile(\"\\nMCI stats: \", f)\n","    recall, specificity, precision, f1 = printClassStats(stats[2])\n","    mciStatValues.append({\n","        \"recall\": recall,\n","        \"specificity\": specificity,\n","        \"precision\": precision,\n","        \"f1\": f1\n","    })\n","    f.close()\n","\n","    print(\"--- Execution End ---\")"]},{"cell_type":"code","execution_count":47,"metadata":{"id":"WuiTfuCMd8j4","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1677514081792,"user_tz":180,"elapsed":15,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}},"outputId":"7e71a4bf-3f05-4a50-a311-fc0b60453f35"},"outputs":[{"output_type":"stream","name":"stdout","text":["Final stats: \n","Executions: 1\n","Accuracy mean: 0.6299999952316284\n","Accuracy std: nan\n","Best accuracy: 0.6299999952316284\n","Worst accuracy: 0.6299999952316284\n"]}],"source":["accuracyValues = torch.tensor(accuracyValues)\n","std, mean = torch.std_mean(accuracyValues)\n","f = open(os.path.join(\n","    os.path.join(experimentOutputFolder, experimentName + '_results.txt')), \"w\")\n","printFile(\"Final stats: \", f)\n","printFile(\"Executions: \" + str(executions), f)\n","printFile(\"Accuracy mean: \" + str(mean.item()), f)\n","printFile(\"Accuracy std: \" + str(std.item()), f)\n","printFile(\"Best accuracy: \" + str(accuracyValues.max().item()), f)\n","printFile(\"Worst accuracy: \" + str(accuracyValues.min().item()), f)\n","f.close()"]},{"cell_type":"markdown","metadata":{"id":"xA-ShjPRUYxP"},"source":["# ROC - AUC"]},{"cell_type":"code","execution_count":48,"metadata":{"id":"mmKtfcWNUOIR","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1677514081792,"user_tz":180,"elapsed":13,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}},"outputId":"b2fb67d8-4477-4f25-a1f8-d7f05024b566"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["def sortByX(point):\n","  return point[0]\n","\n","# Se necesita ordenar los puntos para llamar a torch.trapezoid con los puntos ordenados por la coordenada X\n","def sortListsByX(x, y):\n","    points = zip(x, y)\n","    points = list(points)\n","    points.sort(key=sortByX)\n","    x, y = ([ a for a,b in points ], [ b for a,b in points ])\n","    return x, y\n","\n","fig = plt.figure()\n","ad_y = ad_tpr = [ x[\"recall\"] for x in adStatValues ]\n","ad_x = ad_fpr = [ 1.0 - x[\"specificity\"] for x in adStatValues ]\n","ad_x, ad_y = sortListsByX(ad_x, ad_y)\n","\n","cn_y = cn_tpr = [ x[\"recall\"] for x in cnStatValues ]\n","cn_x = cn_fpr = [ 1.0 - x[\"specificity\"] for x in cnStatValues ]\n","cn_x, cn_y = sortListsByX(cn_x, cn_y)\n","\n","mci_y = mci_tpr = [ x[\"recall\"] for x in mciStatValues ]\n","mci_x = mci_fpr = [ 1.0 - x[\"specificity\"] for x in mciStatValues ]\n","mci_x, mci_y = sortListsByX(mci_x, mci_y)\n","\n","decimals = 3\n","ad_auc = round(torch.trapezoid(torch.tensor(ad_y), torch.tensor(ad_x)).item(), decimals)\n","cn_auc = round(torch.trapezoid(torch.tensor(cn_y), torch.tensor(cn_x)).item(), decimals)\n","mci_auc = round(torch.trapezoid(torch.tensor(mci_y), torch.tensor(mci_x)).item(), decimals)\n","\n","plt.title(experimentName + \" ROC\")\n","\n","plt.plot(ad_fpr, ad_tpr)\n","plt.plot(cn_fpr, cn_tpr)\n","plt.plot(mci_fpr, mci_tpr)\n","\n","plt.legend([\"AD (\"+str(ad_auc)+\")\", \"CN (\"+str(cn_auc)+\")\", \"MCI (\"+str(mci_auc)+\")\"], loc =\"lower right\")\n","plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_auc_roc.png'))\n","    \n","plt.show()"]},{"cell_type":"code","execution_count":49,"metadata":{"id":"yUUyX_2fpMSX","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1677514081792,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}},"outputId":"e853dc73-72b8-4118-e83b-7f9ccd53122c"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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\n"},"metadata":{"needs_background":"light"}}],"source":["fig = plt.figure()\n","ad_y = ad_tpr = [ x[\"recall\"] for x in adStatValues ]\n","ad_x = ad_fpr = [ 1.0 - x[\"specificity\"] for x in adStatValues ]\n","ad_x, ad_y = sortListsByX(ad_x, ad_y)\n","\n","decimals = 3\n","ad_auc = round(torch.trapezoid(torch.tensor(ad_y), torch.tensor(ad_x)).item(), decimals)\n","\n","plt.title(experimentName + \" AD ROC\")\n","\n","plt.plot(ad_fpr, ad_tpr)\n","\n","plt.legend([\"AD (\"+str(ad_auc)+\")\"], loc =\"lower right\")\n","plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_auc_roc_ad.png'))\n","\n","plt.show()"]},{"cell_type":"code","execution_count":50,"metadata":{"id":"8hxzslmopMju","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1677514081793,"user_tz":180,"elapsed":12,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}},"outputId":"7e2676c8-e7ab-4315-dc15-921cd665ed59"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"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zJkzh1NPPbXD89x55528853vZIcdUqz+/Oc/Z/78+QCcdNJJjB8/nksuuWSTY2677TYmTpzIkCFDAJg4cSK33nor06ZNY8qUKRxxxBGce+65m9XvSp7Rm9k27aGHHmLcuHGd1jnrrLO47LLLePnllzus8/vf/36T8zzzzDPsscceAOy+++4brxAqLV26lNGjR2/cHjVqFEuXLgVg8ODBrF+/npUrV3arP+3xjN7M+ozOZt71tO+++3LYYYdx3XXXdVhn+fLlHHjgge2WSdqsb8uMGDGCZcuWMXTo0G4fW8kzejPbph100EE0Nzd3We+cc87hkksuISLaLd9pp502+X77G9/4RpYvXw6kD4ERI0a85piRI0eyZMmSjdstLS2MHDly4/a6devYaaedau5LRxz0ZrZNO+qoo1i/fj2zZs3auG/BggX87ne/26TeAQccwNixY7n55pvbPc+BBx7IokWLNm5PmTJl47do5syZw3HHHfeaYyZNmsTtt9/O6tWrWb16NbfffjuTJk0C0k3iFStWMGbMmJ520UFvZts2SfzsZz9j3rx57Lfffhx00EGcffbZ7L777q+pe+6559LS0tLueY499lh++9vfbtyePn06d9xxBw0NDcybN4/p06cD0NTUxKc//WkAhgwZwvnnn88hhxzCIYccwle+8pWNN2abm5s5/PDDN97c7VEfO7oMqZfGxsZoamqqdzPMbCt55JFHOlzb7m+OP/54Lr30UhoaGnp8ri984QtMmTKFCRMmvKasvTGT1BwRje2dyzN6M7NeMnPmzI3r8j31lre8pd2Q3xz+1o2ZWS/Zf//92X///XvlXJ19Z7+7PKM3s7rra0vIfdnmjJWD3szqauDAgaxcudJhX4O2f49+4MCB3TrOSzdmVlejRo2ipaWF1tbWejelX2j7H6a6w0FvZnU1YMCAbv1vSdZ9XroxMyucg97MrHAOejOzwvW534yV1Ao8Ve92bEHDgGfr3Yg+zmNUG49T17alMdo7Ioa3V9Dngr50kpo6+jVlSzxGtfE4dc1jlHjpxsyscA56M7PCOei3vlldV9nmeYxq43HqmscIr9GbmRXPM3ozs8I56M3MCueg7wFJx0h6VNIiSdPbKf+SpIclLZD0a0l7V5SdJOnx/DipYv84SQ/mc35Lm/Nfx/cxW2ic5udz3p8fr/2fl/uRHo7RrZLWSLql6ph9JP0xn/NGSTtujb5sKVtojGZL+kvF++jtW6ErW19E+LEZD2B74AlgX2BH4AFgbFWd9wGvz88/C9yYnw8Bnsx/Ds7PB+eye4DDAQG/Ao6td1/76DjNBxrr3b96j1HengB8ELil6pi5wNT8/N+Az9a7r31wjGYDH6l3/7b0wzP6zXcosCginoyIDcANwCb/zXtE3BURf8ubfwDa/m3RScAdEbEqIlYDdwDHSNoDGBQRf4j0LrwG+Iet0JctqdfHaSu1e2vqyRgREb8G1lbWz1eCRwE/ybvm0L/fS70+RtsSB/3mGwksqdhuyfs6cgppht7ZsSPz81rP2R9siXFqc3W+3D6/ny9x9WSMOjIUWBMRL9V4zr5uS4xRm6/l5Z5vSHrd5jawL/O/R78VSPok0AgcWe+29GXdHKdPRMRSSbsAPwVOJF0BFc3vpa51c4zOBlaQloNmAWcBF2251tWHZ/SbbykwumJ7VN63CUlHA+cCUyJifRfHLqXicrOjc/YzW2KciIi2P9cC15Eu7furnoxRR1YCu0lqm8z19/fSlhgjImJ5JOuBq+nf76OO1fsmQX99kK6GngT24dWbQwdV1XkH6QZSQ9X+IcBfSDcYB+fnQ3JZ9c3YyfXua18bp3zOYbnOANI69Gn17ms9xqiifDyvvdH4Yza9Gfu5eve1D47RHvlPAVcAM+vd1y0yfvVuQH9+AJOBx/Kb69y87yLSbAJgHvAMcH9+3FRx7KeARfnxTxX7G4GH8jm/Q/7t5f786O1xAt4ANAMLgIXAN4Ht693POo7R74BW4O+ktetJef++pInDohz6r6t3P/vgGN0JPJh/5n4I7Fzvfm6Jh/8JBDOzwnmN3syscA56M7PCOejNzArnoDczK5yD3syscA56M7PCOejNzAr3/wEoZrKNZd1GbgAAAABJRU5ErkJggg==\n"},"metadata":{"needs_background":"light"}}],"source":["fig = plt.figure()\n","\n","cn_y = cn_tpr = [ x[\"recall\"] for x in cnStatValues ]\n","cn_x = cn_fpr = [ 1.0 - x[\"specificity\"] for x in cnStatValues ]\n","cn_x, cn_y = sortListsByX(cn_x, cn_y)\n","\n","decimals = 3\n","cn_auc = round(torch.trapezoid(torch.tensor(cn_y), torch.tensor(cn_x)).item(), decimals)\n","\n","plt.title(experimentName + \" CN ROC\")\n","\n","plt.plot(cn_fpr, cn_tpr)\n","\n","plt.legend([\"CN (\"+str(cn_auc)+\")\"], loc =\"lower right\")\n","plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_auc_roc_cn.png'))\n","\n","plt.show()"]},{"cell_type":"code","execution_count":51,"metadata":{"id":"E9Z0TN2RpMzv","colab":{"base_uri":"https://localhost:8080/","height":281},"executionInfo":{"status":"ok","timestamp":1677514081793,"user_tz":180,"elapsed":11,"user":{"displayName":"Hugo Massaroli","userId":"15440061811672054235"}},"outputId":"5df687d0-de73-4d05-8942-492661bd884c"},"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 432x288 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAAAYcAAAEICAYAAAC0+DhzAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMywgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/NK7nSAAAACXBIWXMAAAsTAAALEwEAmpwYAAAlz0lEQVR4nO3de5gV1Z3u8e87XLzhhUsbDa3CjJ0oGgbNFk1m4hgRRWPAM8MkkOjgROMZc3ycGTUJMyYhkkkGL2f0ycRcmGiCMQGjuZEYBbxFT6KGjRcCJGqHEGhE0wKKN8TW3/mjVkOxq6Gr6W6axvfzPPuhaq1aq9Za7K5f1aq9dykiMDMzy/uznm6AmZntehwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwSxH0oWSnpX0kqTBPd0es57i4LCLkLRC0iZJQ2rSH5UUkoZ1475PktTUBfW8V9KvJb0oabGkv87lvV/SbyQ9L2mtpB9JGprL30PSjZI2SHpG0iWdbc8OtL8f8F/AqRExICLW7uw27O4kDUvv50dr0oek9/+KmvSPSKqmYL1G0h2t7ytJn5d0czv7eSm9Vkia2sZ256b35Svpffc1SQfUbPMOSbdKek7SC+m9fYmkPp0dj12Zg8Ou5Q/A5NYVSe8C9u655mwhqW87+YOAnwJXAwcAVwE/lTQwbbIMOC0iDgDeDjwFfC1XxeeBBuAw4P3ApySN67oebF/q39uAPYGlO1Bekvz3VN7eko7OrX+E7P2/WTpBuA74Etn/zaHAV4EJHdjPARExAJgIfFbS2Fz9lwJXAp8E9gdOIHv/LZDUP23zF8DDwCrgXRGxP/D3QAXYtwPt6H0iwq9d4AWsAD4DLMylXQNcDgQwLKXdB5yf2+Zc4P/l1o8AFgDrgCeAD+XyziA7SL8IrAYuA/YBXgXeBF5Kr7eTHaxvA24GNgDnA6OBB4HngTXAV4D+qe4zgaU1fXoSOK+Nvu4B/CewLJf2NNkZe+v6F4A57YzZSUAT8O/Ac2kMP1qzn2uAlcCzwNeBvWrKfhp4BpgNvJzG+iXgnrTde4GFwAvp3/fm6r8P+CLwyzSGh6fynyALfi+mfvwF8Ks0jt/PjdlA4GdAM7A+LdfX1P+FVP+LwHxgSC7/r1O9z5MdvM5tr9/bGcv22rICOCW3/nng5rT8YbID+35p/fQ0pnVt7GdYGqPPAFfn0qtk7/UVaX3/9P/w99tp8+Y2bGc/fXNpvwY+mZb3S/V/qKbcgDQGH0vrNwO39/TxoSdePtPZtTwE7CfpyHTJOonszVmKpH3IAsP3gANT+a9KGpE2uQH43xGxL3A02QHwZbI/5qcjm0oZEBFPp+0nkAWIA4DvAm8A/woMAd4DjCE7EG5uQm2T0n5a23eopOfJDqSXkV1dkK4uDgYez5V9HDiqRLcPSu0ZCkwBZkp6Z8qbAbwDGEV24B4KfK6m7CCys8WP5fZ3QEScnK6Gbge+DAwmm3K6veZexDnABWRnkX9MaacB7yY7E/0UMBM4GzgkjUfr1eGfAd9K+z80jctXavr3EeAfyf4/+5ONG5IOA+4A/huoS318rGS/21KmLW2KiFvIgtSX09jcQHYC07ydYjcDkyT1Se/PAWRn6K3eQ3YV96MybWiPpBPIxr4xJb031f/Dmr68BPwcaL3COIXsb+Atx8Fh1/Md4B/I3py/JTvDL+tMsjOvb0VES0Q8CvyA7DIY4HVghKT9ImJ9RDzSTn0PRsSPI+LNiHg1IhZFxEOp7hXAN4C/ad0WeLukyZL6SZpCdsa8eVosIlZGNq00hOzM8Xcpa0D694Xcvl+g/GX7ZyPitYj4BdnB/EOSRHbQ/teIWBcRL5JNT0zKlXsTmJbKvtpGvR8AnoqI76Q+z05t/mBum29HxNKU/3pKuyoiNkTEUmAJMD8ilkfEC2QH9GPSeKyNiB9ExCupfV9ky3i2+lZEPJna932yAz5kQeOuiJgdEa+nuh4r2e+Ckm3Znv8DnEx2tfPTiPhZO9s3kV3ZnkL2fv9OTf5g4LmIaOlAG9rynKRXyd6fXwV+nNKHbKf+NSm/tR1rOtmGXmm788jWI74D3A8MB27qYNnDgOPT2Xmrvmz5w/s7soPyDEmLgakR8eB26luVX5H0DrKz5wrZQb8vsAiyg4ukCWTTGdcD84C7yA4CW4mIdZJmAY+nm9Ivpaz9gI255RdL9Hl9uvpp9UeyabG61MZF2fEy6wKQv4nYHBEb2ba3s+VqIF//0Nz6KoqezS2/2sb6QQCS9gauBcaRTesA7CupT0S8kdafyZV9hS2B9BDg923su0y/C0q2ZZsi4nlJtwKXkL3PyriJbFr0vcD7yK52Wq0Fhkjq28kAMYRseumfyQJqP2AT2TTktuo/OOW3tuPgTuy/1/KVwy4mIv5INn97BjWXvMnLbH2T+qDc8irgFxFxQO41ICIuTHUvjIgJZFMUPyY7E4Xsj6fN5tSsf43szLkhIvYjm+vffASKiF9ExHERMYhsuuUIsnnetvRN7dgvItaTnZ39ZS7/Lyl3Y3hgmk5rdSjZ/YvnyA7ER+XGYv/Ibk5uq3+1niYLuHmHsvXVXGd+1vhS4J3A8Wk8T0zptdNzbVlFdmVWq0y/d6Qt23vfIWkU2dTcbLJpuDJ+QHZ1tjwiVtbkPQi8BpxVsq5tiog3IuK/yE48WqdBW+v/2/y2kgaQTbPenZLuonyw2604OOyazgNOrjkjbvUY8LeS9pZ0eNq21c+Ad0g6J03t9JN0XLqH0V/SRyXtn6Y/NpBNq0B2ZjtY0v7ttGvfVO4lSUcAF+YzJR2T9rkf2RXEqoiYl/L+VtI7Jf2ZpDqyK5BHI2JdKn4T8BlJA1PdHwe+3f5QAXBF6t/7yKbWbo2IN4H/Aa6VdGBqw1BJp5WsE7K553ekj1P2lfRhYATZOHeFfckO5M+n+xvTOlD2u8Apkj6U2jZY0qhO9Lu9tjxGdo+gn6QK2ad/SPXvSXYP4d/J7o8MlfQJ2pHe3yeTfdihNu8Fsvsk10s6K73f+0k6XdJV7dW9DTPIPgW3Z6r/CuC/JY1LdQ8jO2FqYsvV9jTgvZKultR6xXe4pJtrP/K6u3Fw2AVFxO8jorqN7GvJLoufBWaRHSRay70InEo2v/w02ZTElWSfXoHsbH6FpA3APwEfTeV+R3bGt1zZ9xDevo19X0Z2af4i2QHolpr8T5Gdua4iuxT/X7m8ocCdqexvyAJTPn8a2TTJH4FfkH2S5c5ttCPvGbJP1zxNNhb/lPoD2SeRGoGHUp/vIjs7LiWy7zmcSXZWvTb178yIeG67Bcu7DtiLbMweIhufsm1bSXZ1eSnZJ9MeY8uV1470u722fJbsSmU92UH1e7m8/yQ7EfhaRLxGdvP9PyQ1lOhHNSLamh4jIv4v2TTVZ8g+QbQKuIgt9w066vbU/o+n+q8iC2jXkJ30tH5kdUzqB6lt7yH79NNSSS+QXfFUKTft2Wspwg/7sd5J0klkH2Ws7+GmmO12fOVgZmYFDg62S5P079ryEwj51x093bbexmNpHeFpJTMzK/CVg5mZFewWX4IbMmRIDBs2rKebYWbWqyxatOi5iKhrK2+3CA7Dhg2jWt3WJz/NzKwtkmp/AWAzTyuZmVmBg4OZmRU4OJiZWYGDg5mZFTg4mJlZQangkH618AlJjWr7Id2XSFqm7MHbd6enVLXm3Zl+zO1nNWWGS3o41XmLtjyzdY+03pjyh3Wyj2Zm1kHtBgdlj6u8nuw3zkcAk7XlsZOtHgUqETGS7JF6+Z/UvZrs10BrXQlcGxGHk/1SYutPT59H9gCXw8l+gfTK8t0xM7OuUObKYTTQmB5zuAmYQ/Zs4c0i4t6IeCWtPgTU5/LupuanbZU9oupktjybdRZbHuoxIa2T8sco90grMzPrfmWCw1C2fhRiE1s/JrHWeWTPyd2ewcDzucfz5evcvL+U/0LafiuSLpBUlVRtbt7ec8zNzKyjuvSGtKSzyZ4vfHVX1tuWiJgZEZWIqNTVtfntbzMz20FlgsNqsoeZt6pn62foAiDpFOByYHzrU5S2Yy1wgKTWn+/I17l5fyl//7S9mZntJGWCw0KgIX26qD/ZIyjn5jeQdAzwDbLA8Kf2Kozsd8LvZctzaKcAP0nLc9M6Kf+e8O+Km5ntVO0GhzTvfxEwD/gt8P2IWCppuqTxabOrgQHArZIek7Q5eEh6ALiV7MZyU+5B558GLpHUSHZP4YaUfgPZw+4byZ4fW/jorJmZda/d4mE/lUol/KusZmYdI2lRRFTayvM3pM3MrMDBwczMChwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwczMChwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwczMChwczMyswMHBzMwKSgUHSeMkPSGpUVLhyWySLpG0TNJiSXdLOiyXN0XSU+k1JaXtm54Y1/p6TtJ1Ke9cSc25vPO7qK9mZlZS3/Y2kNQHuB4YCzQBCyXNjYhluc0eBSoR8YqkC4GrgA9LGgRMAypAAItS2fXAqNw+FgE/zNV3S0Rc1LmumZnZjipz5TAaaIyI5RGxCZgDTMhvEBH3RsQrafUhoD4tnwYsiIh1KSAsAMbly0p6B3Ag8MCOd8PMzLpSmeAwFFiVW29KadtyHnBHB8pOIrtSyD/M+u/SFNVtkg5payeSLpBUlVRtbm4u0Q0zMyurS29ISzqbbArp6g4UmwTMzq3/FBgWESPJrjRmtVUoImZGRCUiKnV1dTvaZDMza0OZ4LAayJ+916e0rUg6BbgcGB8Rr5UpK+kvgb4Rsag1LSLW5sp/E3h3iTaamVkXKhMcFgINkoZL6k92pj83v4GkY4BvkAWGP+Wy5gGnShooaSBwakprNZmtrxqQdHBudTzw27KdMTOzrtHup5UiokXSRWQH9T7AjRGxVNJ0oBoRc8mmkQYAt0oCWBkR4yNinaQvkAUYgOkRsS5X/YeAM2p2ebGk8UALsA44d8e7Z2ZmO0Jb3wfunSqVSlSr1Z5uhplZryJpUURU2srzN6TNzKzAwcHMzAocHMzMrMDBwczMChwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwczMChwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwczMCkoFB0njJD0hqVHS1DbyL5G0TNJiSXdLOiyXN0XSU+k1JZd+X6rzsfQ6MKXvIemWtK+HJQ3rgn6amVkHtBscJPUBrgdOB0YAkyWNqNnsUaASESOB24CrUtlBwDTgeGA0MC09S7rVRyNiVHq1Pnv6PGB9RBwOXAtcucO9MzOzHVLmymE00BgRyyNiEzAHmJDfICLujYhX0upDQH1aPg1YEBHrImI9sAAY187+JgCz0vJtwBilB1ObmdnOUSY4DAVW5dabUtq2nAfcUbLst9KU0mdzAWBzmYhoAV4ABtfuRNIFkqqSqs3NzSW6YWZmZXXpDWlJZwMV4OoSm380It4FvC+9zunIviJiZkRUIqJSV1fX8caamdk2lQkOq4FDcuv1KW0rkk4BLgfGR8Rr7ZWNiNZ/XwS+RzZ9tVUZSX2B/YG15bpjZmZdoUxwWAg0SBouqT8wCZib30DSMcA3yALDn3JZ84BTJQ1MN6JPBeZJ6itpSCrbDzgTWJLKzAVaP9U0EbgnImLHumdmZjuib3sbRESLpIvIDvR9gBsjYqmk6UA1IuaSTSMNAG5Ntw5WRsT4iFgn6QtkAQZgekrbhyxI9Et13gX8T9rmBuA7khqBdWTByMzMdiLtDifllUolqtVqTzfDzKxXkbQoIipt5fkb0mZmVuDgYGZmBQ4OZmZW4OBgZmYFDg5mZlbg4GBmZgUODmZmVuDgYGZmBQ4OZmZW4OBgZmYFDg5mZlbg4GBmZgUODmZmVuDgYGZmBQ4OZmZWUCo4SBon6QlJjZKmtpF/iaRlkhZLulvSYbm8KZKeSq8pKW1vSbdL+p2kpZJm5LY/V1KzpMfS6/yu6KiZmZXXbnCQ1Ae4HjgdGAFMljSiZrNHgUpEjARuA65KZQcB04DjyZ4RPS09LhTgmog4AjgG+CtJp+fquyUiRqXXN3e8e2ZmtiPKXDmMBhojYnlEbALmABPyG0TEvRHxSlp9CKhPy6cBCyJiXUSsBxYA4yLilYi4N5XdBDySK2NmZj2sTHAYCqzKrTeltG05D7ijbFlJBwAfBO7OJf9dmqK6TdIhbe1E0gWSqpKqzc3NJbphZmZldekNaUlnAxXg6pLb9wVmA1+OiOUp+afAsDRFtQCY1VbZiJgZEZWIqNTV1XW+8WZmtlmZ4LAayJ+916e0rUg6BbgcGB8Rr5UsOxN4KiKua02IiLW58t8E3l2ijWZm1oXKBIeFQIOk4ZL6A5OAufkNJB0DfIMsMPwplzUPOFXSwHQj+tSUhqT/APYH/qWmroNzq+OB33aoR2Zm1ml929sgIlokXUR2UO8D3BgRSyVNB6oRMZdsGmkAcKskgJURMT4i1kn6AlmAAZie0urJrjJ+BzySynwlfTLpYknjgRZgHXBuF/bXzMxKUET0dBs6rVKpRLVa7elmmJn1KpIWRUSlrTx/Q9rMzAocHMzMrMDBwczMChwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwczMChwczMyswMHBzMwKHBzMzKzAwcHMzAocHMzMrMDBwczMChwczMysoFRwkDRO0hOSGiVNbSP/EknLJC2WdLekw3J5UyQ9lV5TcunvlvSbVOeXlR4HJ2mQpAVp+wXp8aJmZrYTtRscJPUBrgdOB0YAkyWNqNnsUaASESOB24CrUtlBwDTgeGA0MC13sP8a8HGgIb3GpfSpwN0R0QDcndbNzGwnKnPlMBpojIjlEbEJmANMyG8QEfdGxCtp9SGgPi2fBiyIiHURsR5YAIyTdDCwX0Q8FNlzSm8CzkplJgCz0vKsXLqZme0kZYLDUGBVbr0ppW3LecAd7ZQdmpbbqvNtEbEmLT8DvK2tnUi6QFJVUrW5ublEN8zMrKwuvSEt6WygAlzdFfWlq4rYRt7MiKhERKWurq4rdmdmZkmZ4LAaOCS3Xp/StiLpFOByYHxEvNZO2dVsmXqqrfPZNO1E+vdPJdpoZmZdqExwWAg0SBouqT8wCZib30DSMcA3yAJD/mA+DzhV0sB0I/pUYF6aNtog6YT0KaV/AH6SyswFWj/VNCWXbmZmO0nf9jaIiBZJF5Ed6PsAN0bEUknTgWpEzCWbRhoA3Jo+kboyIsZHxDpJXyALMADTI2JdWv4E8G1gL7J7FK33KWYA35d0HvBH4ENd0E8zM+sAZdP6vVulUolqtdrTzTAz61UkLYqISlt5/oa0mZkVODiYmVmBg4OZmRU4OJiZWYGDg5mZFTg4mJlZgYODmZkVODiYmVmBg4OZmRU4OJiZWYGDg5mZFTg4mJlZgYODmZkVODiYmVmBg4OZmRU4OJiZWUGp4CBpnKQnJDVKmtpG/omSHpHUImliTd6Vkpak14dz6Q9Ieiy9npb045R+kqQXcnmf62Qfzcysg9p9TKikPsD1wFigCVgoaW5ELMttthI4F7ispuwHgGOBUcAewH2S7oiIDRHxvtx2P2DrZ0U/EBFn7lCPzMys08pcOYwGGiNieURsAuYAE/IbRMSKiFgMvFlTdgRwf0S0RMTLwGJgXH4DSfsBJwM/3rEumJlZVysTHIYCq3LrTSmtjMeBcZL2ljQEeD9wSM02ZwF3R8SGXNp7JD0u6Q5JR7VVsaQLJFUlVZubm0s2x8zMymh3WqkzImK+pOOAXwHNwIPAGzWbTQa+mVt/BDgsIl6SdAbZFUVDG3XPBGYCVCqV6PrWm5m9dZW5cljN1mf79SmtlIj4YkSMioixgIAnW/PS1cRo4Pbc9hsi4qW0/HOgX9rOzMx2kjLBYSHQIGm4pP7AJGBumcol9ZE0OC2PBEYC83ObTAR+FhEbc2UOkqS0PDq1cW2Z/ZmZWddod1opIlokXQTMA/oAN0bEUknTgWpEzE1TRz8CBgIflHRFRBwF9AMeSMf6DcDZEdGSq34SMKNmlxOBCyW1AK8CkyLC00ZmZjuRdofjbqVSiWq12tPNMDPrVSQtiohKW3n+hrSZmRU4OJiZWYGDg5mZFTg4mJlZgYODmZkVODiYmVmBg4OZmRU4OJiZWYGDg5mZFTg4mJlZgYODmZkVODiYmVmBg4OZmRU4OJiZWYGDg5mZFZQKDpLGSXpCUqOkqW3knyjpEUktkibW5F0paUl6fTiX/m1Jf5D0WHqNSumS9OW0r8WSju1kH83MrIPafRKcpD7A9cBYoAlYKGluRCzLbbYSOBe4rKbsB4BjgVHAHsB9ku6IiA1pk09GxG01uzwdaEiv44GvpX/NzGwnKXPlMBpojIjlEbEJmANMyG8QESsiYjHwZk3ZEcD9EdESES8Di4Fx7exvAnBTZB4CDpB0cJnOmJlZ1ygTHIYCq3LrTSmtjMeBcZL2ljQEeD9wSC7/i2nq6FpJe3Rkf5IukFSVVG1ubi7ZHDMzK6Nbb0hHxHzg58CvgNnAg8AbKfvfgCOA44BBwKc7WPfMiKhERKWurq7rGm1mZqWCw2q2PtuvT2mlRMQXI2JURIwFBDyZ0tekqaPXgG+RTV91en9mZtZ5ZYLDQqBB0nBJ/YFJwNwylUvqI2lwWh4JjATmp/WD078CzgKWpGJzgX9In1o6AXghItaU75KZmXVWu59WiogWSRcB84A+wI0RsVTSdKAaEXMlHQf8CBgIfFDSFRFxFNAPeCA7/rMBODsiWlLV35VUR3Y18RjwTyn958AZQCPwCvCPXdNVMzMrSxHR023otEqlEtVqtaebYWbWq0haFBGVtvL8DWkzMytwcDAzswIHBzMzK3BwMDOzAgcHMzMrcHAwM7MCBwczMytwcDAzswIHBzMzK3BwMDOzAgcHMzMrcHAwM7MCBwczMytwcDAzswIHBzMzK3BwMDOzglLBQdI4SU9IapQ0tY38EyU9IqlF0sSavCslLUmvD+fSv5vqXCLpRkn9UvpJkl6Q9Fh6fa6znTQzs45pNzhI6gNcD5wOjAAmSxpRs9lK4FzgezVlPwAcC4wCjgcuk7Rfyv4ucATwLmAv4Pxc0QciYlR6Te9gn8zMrJPKXDmMBhojYnlEbALmABPyG0TEiohYDLxZU3YEcH9EtETEy8BiYFwq8/NIgF8D9Z3si5mZdZEywWEosCq33pTSyngcGCdpb0lDgPcDh+Q3SNNJ5wB35pLfI+lxSXdIOqqtiiVdIKkqqdrc3FyyOWZmVkbf7qw8IuZLOg74FdAMPAi8UbPZV8muLh5I648Ah0XES5LOAH4MNLRR90xgJkClUonu6YGZ2VtTmSuH1Wx9tl+f0kqJiC+mewdjAQFPtuZJmgbUAZfktt8QES+l5Z8D/dJVh5mZ7SRlgsNCoEHScEn9gUnA3DKVS+ojaXBaHgmMBOan9fOB04DJEfFmrsxBkpSWR6c2ri3fJTMz66x2p5UiokXSRcA8oA9wY0QslTQdqEbE3DR19CNgIPBBSVdExFFAP+CBdKzfAJwdES2p6q8DfwQeTPk/TJ9MmghcKKkFeBWYlG5am5nZTqLd4bhbqVSiWq32dDPMzHoVSYsiotJWnr8hbWZmBQ4OZmZW4OBgZmYFDg5mZlbg4GBmZgUODmZmVtCtP59hZtYVXn/9dZqamti4cWNPN6VX2nPPPamvr6dfv36lyzg4mNkur6mpiX333Zdhw4aRvjRrJUUEa9eupampieHDh5cu52klM9vlbdy4kcGDBzsw7ABJDB48uMNXXQ4OZtYrODDsuB0ZOwcHMzMrcHAwMytBEmefffbm9ZaWFurq6jjzzDM3p91xxx1UKhVGjBjBMcccw6WXXgrA5z//ea655po2673uuuu46aabAFi3bh1jx46loaGBsWPHsn79+jbLzJo1i4aGBhoaGpg1a9bm9FNOOWWbZTrKwcHMrIR99tmHJUuW8OqrrwKwYMEChg7d8lDMJUuWcNFFF3HzzTezbNkyqtUqhx9++HbrbGlp4cYbb+QjH/kIADNmzGDMmDE89dRTjBkzhhkzZhTKrFu3jiuuuIKHH36YX//611xxxRWbA8I555zDV7/61S7prz+tZGa9yhU/Xcqypzd0aZ0j3r4f0z7Y5hOJt3LGGWdw++23M3HiRGbPns3kyZN54IHsIZZXXXUVl19+OUcccQQAffr04cILL9xufffccw/HHnssfftmh+Kf/OQn3HfffQBMmTKFk046iSuvvHKrMvPmzWPs2LEMGjQIgLFjx3LnnXcyefJkxo8fz/ve9z4uv/zyDvW/Lb5yMDMradKkScyZM4eNGzeyePFijj/++M15S5Ys4d3vfneH6vvlL3+5VZlnn32Wgw8+GICDDjqIZ599tlBm9erVHHLIlodz1tfXs3p19nDOgQMH8tprr7F2beefj+YrBzPrVcqc4XeXkSNHsmLFCmbPns0ZZ5zR6frWrFnDkUce2WaepB36lNGBBx7I008/zeDBgzvVtlJXDpLGSXpCUqOkqW3knyjpEUktkibW5F0paUl6fTiXPlzSw6nOW9IjSJG0R1pvTPnDOtVDM7MuNH78eC677DImT568VfpRRx3FokWLOlTXXnvttdX3D972trexZs0aIAscBx54YKHM0KFDWbVq1eb1pqamre59bNy4kb322qtD7WhLu8FBUh/geuB0YAQwWdKIms1WAucC36sp+wHgWGAUcDxwmaT9UvaVwLURcTiwHjgvpZ8HrE/p16btzMx2CR/72MeYNm0a73rXu7ZK/+QnP8mXvvQlnnzySQDefPNNvv71r2+3riOPPJLGxsbN6+PHj9/86aNZs2YxYcKEQpnTTjuN+fPns379etavX8/8+fM57bTTgOzb0M888wzDhg3rTBeBclcOo4HGiFgeEZuAOcBWLY6IFRGxGHizpuwI4P6IaImIl4HFwDhl10onA7el7WYBZ6XlCWmdlD9G/vaLme0i6uvrufjiiwvpI0eO5LrrrmPy5MkceeSRHH300Sxfvny7dZ1++uncf//9m9enTp3KggULaGho4K677mLq1Gyiplqtcv755wMwaNAgPvvZz3Lcccdx3HHH8bnPfW7zzelFixZxwgknbL7B3SkRsd0XMBH4Zm79HOAr29j228DE3PqpwC+BvYEhwHLg0rTcmNvuEGBJWl4C1Ofyfg8MaWNfFwBVoHrooYeGme2+li1b1tNN6DZnnXVWPPnkk11S18UXXxx33XVXm3ltjSFQjW0c+7v100oRMR/4OfArYDbwIPBGF9U9MyIqEVGpq6vriirNzHa6GTNmbL7P0FlHH300Y8aM6ZK6ygSH1WRn9q3qU1opEfHFiBgVEWMBAU8Ca4EDJLVe++Tr3Ly/lL9/2t7MbLfzzne+kxNPPLFL6vr4xz/eJfVAueCwEGhIny7qD0wC5papXFIfSYPT8khgJDA/Xc7cSzZlBTAF+ElanpvWSfn3pO3N7C3Mh4EdtyNj125wiIgW4CJgHvBb4PsRsVTSdEnjASQdJ6kJ+HvgG5KWpuL9gAckLQNmAmen+gA+DVwiqREYDNyQ0m8ABqf0S4DCR2fN7K1lzz33ZO3atQ4QOyDS8xz23HPPDpXT7jDYlUolqtVqTzfDzLqJnwTXOdt6EpykRRFRaauMvyFtZru8fv36degpZtZ5/m0lMzMrcHAwM7MCBwczMyvYLW5IS2oG/tiNuxgCPNeN9fd2Hp/2eYy2z+PTvu4Yo8Mios1vEe8WwaG7Sapu646+eXzK8Bhtn8enfTt7jDytZGZmBQ4OZmZW4OBQzsyebsAuzuPTPo/R9nl82rdTx8j3HMzMrMBXDmZmVuDgYGZmBW+54CBpnKQnJDVKKvziq6Q9JN2S8h+WNCyl95M0S9JvJP1W0r+VrbO36eoxknSIpHslLZO0VNI/7+QudanueA+l/D6SHpX0s53UlW7TTX9nB0i6TdLvUt57dmKXulQ3jc+/pr+vJZJmS+rYz7DW2tYj4nbHF9CH7LGjfw70Bx4HRtRs8wng62l5EnBLWv4IMCct7w2sAIaVqbM3vbppjA4Gjk3p+5I98KlXjlF3jE+u3CXA94Cf9XQ/d8UxInu2/PlpuT9wQE/3dVcZH2Ao8Adgr5T3feDczrTzrXblMJrs2dXLI2ITMAeYULPNBLI3IcBtwBhJAgLYJz2dbi9gE7ChZJ29SZePUUSsiYhHACLiRbLnggzt/q50i+54DyGpHvgA8M3u70K36/IxkrQ/cCLpuS8RsSkinu/2nnSPbnkPkf3K9l4pb2/g6c408q0WHIYCq3LrTRQPUpu3iezBRC+QPYzoNuBlYA2wErgmItaVrLM36Y4x2ixdHh8DPNwNbd8Zumt8rgM+BbzZXQ3fibpjjIYDzcC30tTbNyXt06296D5dPj4RsRq4JqWtAV6IiPmdaeRbLTh0xmjgDeDtZG/USyX9ec82aZez3TGSNAD4AfAvEbGh7Sp2a22Oj6QzgT9FxKIebd2uYVvvob7AscDXIuIYsgNkr7+/twO29R4aSHa1MTzl7SPp7M7s6K0WHFYDh+TW61Nam9uky7P9gbVkc313RsTrEfEn4JdApWSdvUl3jBGS+pEFhu9GxA+7tQfdqzvG56+A8ZJWkE0xnCzp5u7sRDfrjjFqApoiovWK8zayYNEbdcf4nAL8ISKaI+J14IfAezvTyLdacFgINEgaLqk/2Y2euTXbzAWmpOWJwD2R3eFZCZwMkC5nTwB+V7LO3qTLxyjNld4A/DYi/msn9KE7dfn4RMS/RUR9RAxL9d0TEZ066+th3TFGzwCrJL0zlRkDLOvebnSb7jgOrQROkLR3+nsbQ3Zvb8f19J37nf0CziD7tMzvgctT2nRgfFreE7gVaAR+Dfx5Sh+Q0peSvSk/ub06e/Orq8cI+GuyG2mLgcfS64ye7ueuMj41dZ9EL/+0UneNETAKqKb30Y+BgT3dz11sfK4gCxRLgO8Ae3Smjf75DDMzK3irTSuZmVkJDg5mZlbg4GBmZgUODmZmVuDgYGZmBQ4OZmZW4OBgZmYF/x/hdbSf3pMu+QAAAABJRU5ErkJggg==\n"},"metadata":{"needs_background":"light"}}],"source":["fig = plt.figure()\n","\n","mci_y = mci_tpr = [ x[\"recall\"] for x in mciStatValues ]\n","mci_x = mci_fpr = [ 1.0 - x[\"specificity\"] for x in mciStatValues ]\n","mci_x, mci_y = sortListsByX(mci_x, mci_y)\n","\n","decimals = 3\n","mci_auc = round(torch.trapezoid(torch.tensor(mci_y), torch.tensor(mci_x)).item(), decimals)\n","\n","plt.title(experimentName + \" MCI ROC\")\n","\n","plt.plot(mci_fpr, mci_tpr)\n","\n","plt.legend([\"MCI (\"+str(mci_auc)+\")\"], loc =\"lower right\")\n","plt.savefig(os.path.join(experimentOutputFolder, experimentExecutionName + '_auc_roc_mci.png'))\n","\n","plt.show()"]}],"metadata":{"accelerator":"GPU","colab":{"provenance":[{"file_id":"1r1HNUpbYS9M5mxjABQVENXOomeZs7bz3","timestamp":1677512393443},{"file_id":"17yE6VgODz9fuwCS9xxQasjwRDcQFYgpA","timestamp":1677506841076},{"file_id":"1vR1OejytPvS6AE6R3Atvrb4Et7pBtlCv","timestamp":1677506777011},{"file_id":"1foEkZEhBn-dpgauOPty7a0dCB7sLuKQZ","timestamp":1677506570237},{"file_id":"1y4lw-wXrz-5L5wGqE1-yugbzsH9Ll8dX","timestamp":1677158649041}]},"gpuClass":"premium","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}